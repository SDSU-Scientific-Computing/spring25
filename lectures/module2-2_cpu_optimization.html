
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7) CPU Optimization: Matrix-Matrix Multiply &#8212; Scientific Computing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/module2-2_cpu_optimization';</script>
    <link rel="icon" href="../_static/SDSU-comp605_logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8) Blocked Matrix-Matrix Multiplication" href="module2-3_blocked_mmm.html" />
    <link rel="prev" title="6) Measuring Performance" href="module2-1_measuring_performance.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-light" alt="Scientific Computing - Home"/>
    <script>document.write(`<img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-dark" alt="Scientific Computing - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../lectures.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module1-1_first_class.html">1) First Class: Reproducibility and Git</a></li>


<li class="toctree-l2"><a class="reference internal" href="module1-2_linux.html">2) The Linux Filesystem and commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-3_community_projects.html">3) Community Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-4_intro_architectures.html">4) Introduction to Computer Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-5_intro_vectorization.html">5) Introduction to Vectorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-1_measuring_performance.html">6) Measuring Performance</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">7) CPU Optimization: Matrix-Matrix Multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-3_blocked_mmm.html">8) Blocked Matrix-Matrix Multiplication</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25/issues/new?title=Issue%20on%20page%20%2Flectures/module2-2_cpu_optimization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/module2-2_cpu_optimization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>7) CPU Optimization: Matrix-Matrix Multiply</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-cpu-optimization">1. Introduction to CPU Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-matrix-multiply">1.1 Matrix-Matrix Multiply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering">2. Loop ordering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ijp">2.1 Loop ordering: ijp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ipj">2.2 Loop ordering: ipj</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pij">2.3 Loop ordering: pij</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pji">2.4 Loop ordering: pji</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jpi">2.5 Loop ordering: jpi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jip">2.6 Loop ordering: jip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-and-observations">Questions and observations:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cpu-optimization-matrix-matrix-multiply">
<h1>7) CPU Optimization: Matrix-Matrix Multiply<a class="headerlink" href="#cpu-optimization-matrix-matrix-multiply" title="Link to this heading">#</a></h1>
<p>Last time:</p>
<ul class="simple">
<li><p>Measuring performance</p></li>
</ul>
<p>Today:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#introduction-to-cpu-optimization"><span class="xref myst">Introduction to CPU Optimization</span></a><br />
1.1 <a class="reference internal" href="#matrix-matrix-multiply"><span class="xref myst">Matrix-Matrix Multiply</span></a></p></li>
<li><p><a class="reference internal" href="#loop-ordering"><span class="xref myst">Loop ordering</span></a></p></li>
</ol>
<section id="introduction-to-cpu-optimization">
<h2>1. Introduction to CPU Optimization<a class="headerlink" href="#introduction-to-cpu-optimization" title="Link to this heading">#</a></h2>
<p>In this module we talk about optimizing matrix-matrix multiply on the CPU. Some of the material here is largely based on the <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/LAFF-On-PfHP.html">LAFF-On Programming for High Performance</a> of Robert van de Geijn,
Margaret Myers, Devangi Parikh, which has a pairing online MOOC: <a class="reference external" href="https://www.cs.utexas.edu/users/flame/laff/pfhp/LAFF-On-PfHP.html">LAFF-On Programming for High Performance (LAFF-On-PfHP)</a>.</p>
<p>I encourage you to watch the videos before class. When watching the videos, really you should be watching for the <em>big picture</em> and we will revisit most of the material in lecture as well, mainly you will have a better learning experience if the in class lectures are the first time you’ve seen some of the material.</p>
<p>The MOOC is done using C (not Julia), so some of the syntax and language discussion is not relevant, but the overall ideas apply.</p>
<p>Two big differences between the material presented in C Vs Julia:</p>
<ol class="arabic simple">
<li><p>Julia starts it’s indexing with <code class="docutils literal notranslate"><span class="pre">1</span></code> whereas C uses <code class="docutils literal notranslate"><span class="pre">0</span></code>, so the first element of an array <code class="docutils literal notranslate"><span class="pre">A</span></code> in Julia is:</p></li>
</ol>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>whereas in C is:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The second difference is that in C, matrices are not
really first-class objects so they must be indexed as flat vectors. In Julia, even though behind the scenes everything is a flat vector, we can index into matrices directly.</p></li>
</ol>
<p>Some additional Julia related material was gleaned from Sacha Verweij’s repository <a class="reference external" href="https://github.com/Sacha0/GemmDemo.jl">GemmDemo.jl</a> and from a former colleague, Maciej Waruszewski’s repository <a class="reference external" href="https://github.com/mwarusz/MyJuliaGEMM">MyJuliaGEMM</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Gemm in the name of the routine stands for <strong>General Matrix-Matrix multiplication</strong>. Gemm is an acronym that is widely used in scientific computing, with roots in the Basic Linear Algebra Subprograms (BLAS).</p>
</div>
<p>Why do we care about CPU optimization (and not just MPI). Again, because of this:</p>
<p><img alt="42 years of microprocessor data" src="https://www.karlrupp.net/wp-content/uploads/2018/02/42-years-processor-trend.png" /></p>
<p>Source: <a class="reference external" href="https://github.com/karlrupp/microprocessor-trend-data">Microprocessor Trend Data</a>.</p>
<blockquote>
<div><p>Related videos and texts:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=knTLy1j-rco">1.1.1 Launch, part 1</a> (time 7:51), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-launch.html">text</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=cRyVMrNNRCk">GFLOPS</a> (time: 5:31), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-launch.html">text</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=PhjildK5oO8">1.2.2  The leading dimension of a matrix</a>
(time: 4:02), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-the-leading-dimension.html">text</a>.</p></li>
</ul>
</div></blockquote>
<section id="matrix-matrix-multiply">
<h3>1.1 Matrix-Matrix Multiply<a class="headerlink" href="#matrix-matrix-multiply" title="Link to this heading">#</a></h3>
<p>We will focus on matrix-matrix multiplication:</p>
<div class="math notranslate nohighlight">
\[
C = C + A * B
\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is <span class="math notranslate nohighlight">\(m \times n\)</span>, <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(m \times k\)</span>, and <span class="math notranslate nohighlight">\(B\)</span> is <span class="math notranslate nohighlight">\(k \times n\)</span>.</p>
<p>The formula we learn for this in Linear Algebra is the following:</p>
<div class="math notranslate nohighlight">
\[
γ_{ij} = γ_{ij} + \sum_{p=1}^{k} α_{ip} β_{pj}
\]</div>
<p>where <span class="math notranslate nohighlight">\(γ_{ij}\)</span>, <span class="math notranslate nohighlight">\(α_{ip}\)</span>, and <span class="math notranslate nohighlight">\(β_{pj}\)</span> are the elements of the matrices <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(B\)</span>, respectively.</p>
<section id="notation">
<h4>Notation<a class="headerlink" href="#notation" title="Link to this heading">#</a></h4>
<p>See <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-notation.html">text 1.3.1 Notation</a>.</p>
<ul class="simple">
<li><p>Capital letters for matrices <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, etc.</p></li>
<li><p>lower case letters for vectors <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, etc.</p></li>
<li><p>lower case Greek letters for floating point scalars
<span class="math notranslate nohighlight">\(α\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(A\)</span>),
<span class="math notranslate nohighlight">\(β\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(B\)</span>),
<span class="math notranslate nohighlight">\(γ\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(C\)</span>),</p></li>
<li><p>lower case letters for integer scalars <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(k\)</span> (for matrix sizes) and <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(p\)</span> for element indices</p></li>
<li><p>Often useful to think of matrices as collections of column and/or row vectors:</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(m \times k\)</span> matrix, then we expose its columns as</p>
<div class="math notranslate nohighlight">
\[
 A = [a_1 | a_2 | \dots | a_k] 
\]</div>
<p>so that <span class="math notranslate nohighlight">\(a_j\)</span> equals the column with index <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>We can expose its rows as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A =
   \begin{bmatrix}
     \tilde{a}_{1}^{T}\\
     \tilde{a}_{2}^{T}\\
     \ddots\\
     \tilde{a}_{m}^{T}
   \end{bmatrix}
\end{split}\]</div>
<p>so that <span class="math notranslate nohighlight">\(\tilde{a}_{i}\)</span> equals the row at index <span class="math notranslate nohighlight">\(i\)</span>. Here the <span class="math notranslate nohighlight">\(^T\)</span> indicates it is a row (a column vector that has been transposed). The tilde is added for clarity since <span class="math notranslate nohighlight">\(a^T_i\)</span>  would in this setting equal the column indexed with <span class="math notranslate nohighlight">\(i\)</span> that has been transposed, rather than the row indexed with <span class="math notranslate nohighlight">\(i\)</span> or any subset of the vector. When there isn’t a cause for confusion, we will sometimes leave the tilde off.</p>
<ul class="simple">
<li><p>Note that we think of all vectors as column vectors by default.</p></li>
</ul>
</section>
</section>
</section>
<section id="loop-ordering">
<h2>2. Loop ordering<a class="headerlink" href="#loop-ordering" title="Link to this heading">#</a></h2>
<p>See <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-ordering-the-loops.html">text 1.2.4 Ordering the loops</a>.</p>
<p>When the above formula is implemented as a triply nested loop:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
</pre></div>
</div>
<p>The loop ordering does not impact the correctness of the algorithm. Each of the loop orderings can be interpreted slightly differently.</p>
<p>In the example above, we call “ijp” the loop ordering, since the loop index variables appear from outer most loop to inner most loop this way.</p>
<section id="loop-ordering-ijp">
<h3>2.1 Loop ordering: ijp<a class="headerlink" href="#loop-ordering-ijp" title="Link to this heading">#</a></h3>
<p>Row vectors of <span class="math notranslate nohighlight">\(A\)</span> times the matrix <span class="math notranslate nohighlight">\(B\)</span> (update rows of <span class="math notranslate nohighlight">\(C\)</span>):</p>
<div class="math notranslate nohighlight">
\[
  \tilde{c}_{i}^T = \tilde{c}_{i}^{T} + \tilde{a}_{i}^T B
\]</div>
<p>with inner <span class="math notranslate nohighlight">\(\tilde{a}_{i}^T B\)</span> computed using dot products (update <span class="math notranslate nohighlight">\(\gamma_{ij}\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \tilde{a}_{i}^T B =
   \begin{bmatrix}
     \tilde{a}_{i}^T b_1 &amp; \cdots &amp; \tilde{a}_{i}^T b_m
   \end{bmatrix}
\]</div>
<p><img alt="ijp loop ordering" src="../_images/ijp.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Row vectors of A times the matrix B (update rows of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ijp!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_ijp! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong>:</p>
<p>In the code above (and codes below) we have used the <code class="docutils literal notranslate"><span class="pre">&#64;inbounds</span></code> macro in Julia. This tells the compiler to avoid <a class="reference external" href="https://docs.julialang.org/en/v1/devdocs/boundscheck/">bounds checking</a> that would normally be applied to ensure program safety when accessing arrays. Use this to improve runtime performance <em>only if</em> you are extremely confident that your code might not try to access/read/write out of bounds data.</p>
</section>
<section id="loop-ordering-ipj">
<h3>2.2 Loop ordering: ipj<a class="headerlink" href="#loop-ordering-ipj" title="Link to this heading">#</a></h3>
<p>Row vectors of <span class="math notranslate nohighlight">\(A\)</span> times the matrix <span class="math notranslate nohighlight">\(B\)</span> (update rows of <span class="math notranslate nohighlight">\(C\)</span>):</p>
<div class="math notranslate nohighlight">
\[
  \tilde{c}_{i}^T = \tilde{c}_{i}^{T} + \tilde{a}_{i}^T B
\]</div>
<p>but this time with inner product <span class="math notranslate nohighlight">\(\tilde{a}_{i}^T B\)</span> computed using <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms"><code class="docutils literal notranslate"><span class="pre">axpy</span></code></a>, scalar times vector plus vector (update rows of C, <span class="math notranslate nohighlight">\(\tilde{c}_{i}^T\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \tilde{a}_{i}^T B = \sum_{p=1}^{k} \alpha_{ip} \tilde{b}_p^T
\]</div>
<p><img alt="ipj loop ordering" src="../_images/ipj.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Row vectors of A times the matrix B (update rows of `C`) with inner `axpy`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ipj!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">          </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_ipj! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-pij">
<h3>2.3 Loop ordering: pij<a class="headerlink" href="#loop-ordering-pij" title="Link to this heading">#</a></h3>
<p>Rank one update (repeatedly update all elements of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  C = C + \sum_{p=1}^{k} a_{p} \tilde{b}_{p}^T
\]</div>
<p>with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with vector <span class="math notranslate nohighlight">\(\tilde{b}_{p}^{T}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    \alpha_{1p} \tilde{b}_{p}^T\\
    \vdots\\
    \alpha_{np} \tilde{b}_{p}^T
  \end{bmatrix}
\end{split}\]</div>
<p><img alt="pij loop ordering" src="../_images/pij.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using `axpy` with rows of `B`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pij!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">          </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_pij! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-pji">
<h3>2.4 Loop ordering: pji<a class="headerlink" href="#loop-ordering-pji" title="Link to this heading">#</a></h3>
<p>Rank one update (repeatedly update all elements of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  C = C + \sum_{p=1}^{k} a_{p} \tilde{b}_{p}^T
\]</div>
<p>with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with column vector <span class="math notranslate nohighlight">\(a_{p}\)</span></p>
<div class="math notranslate nohighlight">
\[
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    a_{p} \beta_{p1} &amp; \cdots &amp; a_{p} \beta_{pm}
  \end{bmatrix}
\]</div>
<p><img alt="pji loop ordering" src="../_images/pji.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using `axpy` with columns of `A`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pji!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">          </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_pji! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-jpi">
<h3>2.5 Loop ordering: jpi<a class="headerlink" href="#loop-ordering-jpi" title="Link to this heading">#</a></h3>
<p>Matrix times column vector (update columns of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  c_j = c_{j} + A b_j
\]</div>
<p>with inner products <span class="math notranslate nohighlight">\(A b_j\)</span> computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code>:</p>
<div class="math notranslate nohighlight">
\[
  A b_j = \sum_{p=1}^{k} a_{p}\beta_{pj}
\]</div>
<p><img alt="jpi loop ordering" src="../_images/jpi.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times column vector (update columns of `C`) with inner `axpy`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jpi!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">          </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jpi! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-jip">
<h3>2.6 Loop ordering: jip<a class="headerlink" href="#loop-ordering-jip" title="Link to this heading">#</a></h3>
<p>Matrix times column vector (update columns of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  c_j = c_{j} + A b_j
\]</div>
<p>with inner products <span class="math notranslate nohighlight">\(A b_j\)</span> computed using dot products</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A b_j =
  \begin{bmatrix}
    \tilde{a}_{1}^{T} b_{j}\\
    \vdots\\
    \tilde{a}_{n}^{T} b_{j}\\
  \end{bmatrix}
\end{split}\]</div>
<p><img alt="jip loop ordering" src="../_images/jip.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jip!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">    </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">          </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jip! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h3>
<p>We now want to test all these different implementations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># What modules / packages do we depend on</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Printf</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="n">default</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c"># Plots embelishments</span>

<span class="c"># To ensure repeatability</span>
<span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">777</span><span class="p">)</span>

<span class="c"># Don&#39;t let BLAS use lots of threads (since we are not multi-threaded yet!)</span>
<span class="n">BLAS</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># C := α * A * B + β * C</span>
<span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mul!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span>

<span class="c"># Algo 2.1: matrix times row vector (update rows of `C`) with inner dot product</span>
<span class="n">mygemm!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mygemm_ijp!</span>

<span class="c"># Algo 2.2: matrix times row vector (update rows of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_ipj!</span>

<span class="c"># Algo 2.3: Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with rows of `B`</span>
<span class="c"># mygemm! = mygemm_pij!</span>

<span class="c"># Algo 2.4: Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with columns of `A`</span>
<span class="c"># mygemm! = mygemm_pji!</span>

<span class="c"># Algo 2.5: matrix times column vector (update columns of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_jpi!</span>

<span class="c"># Algo 2.6: matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="c"># mygemm! = mygemm_jip!</span>

<span class="n">num_reps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="c"># What precision numbers to use</span>
<span class="c"># FloatType = Float32</span>
<span class="n">FloatType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span>

<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;size |      reference      |           </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">)</span>
<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;     |   seconds   GFLOPS  |   seconds   GFLOPS     diff</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">480</span>
<span class="n">best_perf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="c"># Size of square matrix to consider</span>
<span class="k">for</span><span class="w"> </span><span class="n">nmk</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">N</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Int</span><span class="p">(</span><span class="n">nmk</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nmk</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%4d</span><span class="s"> |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nmk</span><span class="p">)</span>

<span class="w">  </span><span class="n">gflops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-09</span>

<span class="w">  </span><span class="c"># Create some random initial data</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Make a copy of C for resetting data later</span>
<span class="w">  </span><span class="n">C_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="w">  </span><span class="c"># &quot;truth&quot;</span>
<span class="w">  </span><span class="n">C_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span>

<span class="w">  </span><span class="c"># Compute the reference timings</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="c"># Make sure that we have the right answer!</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">C_ref</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Print the reference implementation timing</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">  |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="w">  </span><span class="c"># Compute the timing for mygemm! implementation</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Compute the error (difference between our implementation and the reference)</span>
<span class="w">  </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">C</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">C_ref</span><span class="p">,</span><span class="w"> </span><span class="nb">Inf</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Print mygemm! implementations</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">   </span><span class="si">%.2e</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">diff</span><span class="p">)</span>

<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot!</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">,</span><span class="w"> </span><span class="n">xlabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m = n = k&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GFLOPs/S&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$mygemm!</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size |      reference      |           mygemm_ijp!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  48 |  1.04e-05    21.21  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8.37e-05     2.64   7.11e-15
  96 |  4.47e-05    39.55  |  8.48e-04     2.09   1.42e-14
 144 |  1.38e-04    43.25  |  3.11e-03     1.92   3.55e-14
 192 |  3.15e-04    45.01  |  7.84e-03     1.80   3.55e-14
 240 |  5.88e-04    47.03  |  1.54e-02     1.80   5.68e-14
 288 |  1.01e-03    47.48  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2.66e-02     1.79   1.85e-13
 336 |  1.59e-03    47.74  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4.33e-02     1.75   2.13e-13
 384 |  2.34e-03    48.43  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8.43e-02     1.34   2.42e-13
 432 |  3.28e-03    49.13  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9.19e-02     1.75   2.84e-13
 480 |  4.72e-03    46.86  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.26e-01     1.76   3.41e-13
</pre></div>
</div>
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip540">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip540)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip541">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip540)" d="M249.195 1423.18 L2352.76 1423.18 L2352.76 47.2441 L249.195 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip542">
    <rect x="249" y="47" width="2105" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="547.604,1423.18 547.604,47.2441 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1006.98,1423.18 1006.98,47.2441 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1466.35,1423.18 1466.35,47.2441 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1925.72,1423.18 1925.72,47.2441 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="249.195,1227.14 2352.76,1227.14 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="249.195,977.352 2352.76,977.352 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="249.195,727.563 2352.76,727.563 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="249.195,477.773 2352.76,477.773 "/>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="249.195,227.984 2352.76,227.984 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="547.604,1423.18 547.604,1404.28 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1006.98,1423.18 1006.98,1404.28 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1466.35,1423.18 1466.35,1404.28 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1925.72,1423.18 1925.72,1404.28 "/>
<path clip-path="url(#clip540)" d="M507.21 1481.64 L514.849 1481.64 L514.849 1455.28 L506.539 1456.95 L506.539 1452.69 L514.803 1451.02 L519.479 1451.02 L519.479 1481.64 L527.118 1481.64 L527.118 1485.58 L507.21 1485.58 L507.21 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M546.562 1454.1 Q542.951 1454.1 541.122 1457.66 Q539.317 1461.2 539.317 1468.33 Q539.317 1475.44 541.122 1479.01 Q542.951 1482.55 546.562 1482.55 Q550.196 1482.55 552.002 1479.01 Q553.83 1475.44 553.83 1468.33 Q553.83 1461.2 552.002 1457.66 Q550.196 1454.1 546.562 1454.1 M546.562 1450.39 Q552.372 1450.39 555.428 1455 Q558.506 1459.58 558.506 1468.33 Q558.506 1477.06 555.428 1481.67 Q552.372 1486.25 546.562 1486.25 Q540.752 1486.25 537.673 1481.67 Q534.618 1477.06 534.618 1468.33 Q534.618 1459.58 537.673 1455 Q540.752 1450.39 546.562 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M576.724 1454.1 Q573.113 1454.1 571.284 1457.66 Q569.478 1461.2 569.478 1468.33 Q569.478 1475.44 571.284 1479.01 Q573.113 1482.55 576.724 1482.55 Q580.358 1482.55 582.164 1479.01 Q583.992 1475.44 583.992 1468.33 Q583.992 1461.2 582.164 1457.66 Q580.358 1454.1 576.724 1454.1 M576.724 1450.39 Q582.534 1450.39 585.589 1455 Q588.668 1459.58 588.668 1468.33 Q588.668 1477.06 585.589 1481.67 Q582.534 1486.25 576.724 1486.25 Q570.914 1486.25 567.835 1481.67 Q564.779 1477.06 564.779 1468.33 Q564.779 1459.58 567.835 1455 Q570.914 1450.39 576.724 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M970.669 1481.64 L986.988 1481.64 L986.988 1485.58 L965.044 1485.58 L965.044 1481.64 Q967.706 1478.89 972.289 1474.26 Q976.896 1469.61 978.076 1468.27 Q980.322 1465.74 981.201 1464.01 Q982.104 1462.25 982.104 1460.56 Q982.104 1457.8 980.16 1456.07 Q978.238 1454.33 975.136 1454.33 Q972.937 1454.33 970.484 1455.09 Q968.053 1455.86 965.275 1457.41 L965.275 1452.69 Q968.099 1451.55 970.553 1450.97 Q973.007 1450.39 975.044 1450.39 Q980.414 1450.39 983.609 1453.08 Q986.803 1455.77 986.803 1460.26 Q986.803 1462.39 985.993 1464.31 Q985.206 1466.2 983.099 1468.8 Q982.521 1469.47 979.419 1472.69 Q976.317 1475.88 970.669 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1006.8 1454.1 Q1003.19 1454.1 1001.36 1457.66 Q999.558 1461.2 999.558 1468.33 Q999.558 1475.44 1001.36 1479.01 Q1003.19 1482.55 1006.8 1482.55 Q1010.44 1482.55 1012.24 1479.01 Q1014.07 1475.44 1014.07 1468.33 Q1014.07 1461.2 1012.24 1457.66 Q1010.44 1454.1 1006.8 1454.1 M1006.8 1450.39 Q1012.61 1450.39 1015.67 1455 Q1018.75 1459.58 1018.75 1468.33 Q1018.75 1477.06 1015.67 1481.67 Q1012.61 1486.25 1006.8 1486.25 Q1000.99 1486.25 997.914 1481.67 Q994.859 1477.06 994.859 1468.33 Q994.859 1459.58 997.914 1455 Q1000.99 1450.39 1006.8 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1036.96 1454.1 Q1033.35 1454.1 1031.53 1457.66 Q1029.72 1461.2 1029.72 1468.33 Q1029.72 1475.44 1031.53 1479.01 Q1033.35 1482.55 1036.96 1482.55 Q1040.6 1482.55 1042.4 1479.01 Q1044.23 1475.44 1044.23 1468.33 Q1044.23 1461.2 1042.4 1457.66 Q1040.6 1454.1 1036.96 1454.1 M1036.96 1450.39 Q1042.78 1450.39 1045.83 1455 Q1048.91 1459.58 1048.91 1468.33 Q1048.91 1477.06 1045.83 1481.67 Q1042.78 1486.25 1036.96 1486.25 Q1031.15 1486.25 1028.08 1481.67 Q1025.02 1477.06 1025.02 1468.33 Q1025.02 1459.58 1028.08 1455 Q1031.15 1450.39 1036.96 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1440.11 1466.95 Q1443.47 1467.66 1445.34 1469.93 Q1447.24 1472.2 1447.24 1475.53 Q1447.24 1480.65 1443.72 1483.45 Q1440.2 1486.25 1433.72 1486.25 Q1431.55 1486.25 1429.23 1485.81 Q1426.94 1485.39 1424.49 1484.54 L1424.49 1480.02 Q1426.43 1481.16 1428.75 1481.74 Q1431.06 1482.32 1433.58 1482.32 Q1437.98 1482.32 1440.27 1480.58 Q1442.59 1478.84 1442.59 1475.53 Q1442.59 1472.48 1440.44 1470.77 Q1438.31 1469.03 1434.49 1469.03 L1430.46 1469.03 L1430.46 1465.19 L1434.67 1465.19 Q1438.12 1465.19 1439.95 1463.82 Q1441.78 1462.43 1441.78 1459.84 Q1441.78 1457.18 1439.88 1455.77 Q1438 1454.33 1434.49 1454.33 Q1432.57 1454.33 1430.37 1454.75 Q1428.17 1455.16 1425.53 1456.04 L1425.53 1451.88 Q1428.19 1451.14 1430.5 1450.77 Q1432.84 1450.39 1434.9 1450.39 Q1440.23 1450.39 1443.33 1452.83 Q1446.43 1455.23 1446.43 1459.35 Q1446.43 1462.22 1444.79 1464.21 Q1443.14 1466.18 1440.11 1466.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1466.11 1454.1 Q1462.5 1454.1 1460.67 1457.66 Q1458.86 1461.2 1458.86 1468.33 Q1458.86 1475.44 1460.67 1479.01 Q1462.5 1482.55 1466.11 1482.55 Q1469.74 1482.55 1471.55 1479.01 Q1473.38 1475.44 1473.38 1468.33 Q1473.38 1461.2 1471.55 1457.66 Q1469.74 1454.1 1466.11 1454.1 M1466.11 1450.39 Q1471.92 1450.39 1474.97 1455 Q1478.05 1459.58 1478.05 1468.33 Q1478.05 1477.06 1474.97 1481.67 Q1471.92 1486.25 1466.11 1486.25 Q1460.3 1486.25 1457.22 1481.67 Q1454.16 1477.06 1454.16 1468.33 Q1454.16 1459.58 1457.22 1455 Q1460.3 1450.39 1466.11 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1496.27 1454.1 Q1492.66 1454.1 1490.83 1457.66 Q1489.02 1461.2 1489.02 1468.33 Q1489.02 1475.44 1490.83 1479.01 Q1492.66 1482.55 1496.27 1482.55 Q1499.9 1482.55 1501.71 1479.01 Q1503.54 1475.44 1503.54 1468.33 Q1503.54 1461.2 1501.71 1457.66 Q1499.9 1454.1 1496.27 1454.1 M1496.27 1450.39 Q1502.08 1450.39 1505.13 1455 Q1508.21 1459.58 1508.21 1468.33 Q1508.21 1477.06 1505.13 1481.67 Q1502.08 1486.25 1496.27 1486.25 Q1490.46 1486.25 1487.38 1481.67 Q1484.32 1477.06 1484.32 1468.33 Q1484.32 1459.58 1487.38 1455 Q1490.46 1450.39 1496.27 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1898.81 1455.09 L1887.01 1473.54 L1898.81 1473.54 L1898.81 1455.09 M1897.59 1451.02 L1903.47 1451.02 L1903.47 1473.54 L1908.4 1473.54 L1908.4 1477.43 L1903.47 1477.43 L1903.47 1485.58 L1898.81 1485.58 L1898.81 1477.43 L1883.21 1477.43 L1883.21 1472.92 L1897.59 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1926.13 1454.1 Q1922.52 1454.1 1920.69 1457.66 Q1918.88 1461.2 1918.88 1468.33 Q1918.88 1475.44 1920.69 1479.01 Q1922.52 1482.55 1926.13 1482.55 Q1929.76 1482.55 1931.57 1479.01 Q1933.4 1475.44 1933.4 1468.33 Q1933.4 1461.2 1931.57 1457.66 Q1929.76 1454.1 1926.13 1454.1 M1926.13 1450.39 Q1931.94 1450.39 1934.99 1455 Q1938.07 1459.58 1938.07 1468.33 Q1938.07 1477.06 1934.99 1481.67 Q1931.94 1486.25 1926.13 1486.25 Q1920.32 1486.25 1917.24 1481.67 Q1914.18 1477.06 1914.18 1468.33 Q1914.18 1459.58 1917.24 1455 Q1920.32 1450.39 1926.13 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1956.29 1454.1 Q1952.68 1454.1 1950.85 1457.66 Q1949.04 1461.2 1949.04 1468.33 Q1949.04 1475.44 1950.85 1479.01 Q1952.68 1482.55 1956.29 1482.55 Q1959.92 1482.55 1961.73 1479.01 Q1963.56 1475.44 1963.56 1468.33 Q1963.56 1461.2 1961.73 1457.66 Q1959.92 1454.1 1956.29 1454.1 M1956.29 1450.39 Q1962.1 1450.39 1965.16 1455 Q1968.23 1459.58 1968.23 1468.33 Q1968.23 1477.06 1965.16 1481.67 Q1962.1 1486.25 1956.29 1486.25 Q1950.48 1486.25 1947.4 1481.67 Q1944.35 1477.06 1944.35 1468.33 Q1944.35 1459.58 1947.4 1455 Q1950.48 1450.39 1956.29 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1164.67 1539.24 Q1166.87 1535.29 1169.92 1533.41 Q1172.98 1531.54 1177.11 1531.54 Q1182.68 1531.54 1185.71 1535.45 Q1188.73 1539.33 1188.73 1546.53 L1188.73 1568.04 L1182.84 1568.04 L1182.84 1546.72 Q1182.84 1541.59 1181.03 1539.11 Q1179.22 1536.63 1175.49 1536.63 Q1170.94 1536.63 1168.3 1539.65 Q1165.66 1542.68 1165.66 1547.9 L1165.66 1568.04 L1159.77 1568.04 L1159.77 1546.72 Q1159.77 1541.56 1157.95 1539.11 Q1156.14 1536.63 1152.35 1536.63 Q1147.86 1536.63 1145.22 1539.68 Q1142.58 1542.71 1142.58 1547.9 L1142.58 1568.04 L1136.69 1568.04 L1136.69 1532.4 L1142.58 1532.4 L1142.58 1537.93 Q1144.59 1534.66 1147.39 1533.1 Q1150.19 1531.54 1154.04 1531.54 Q1157.92 1531.54 1160.63 1533.51 Q1163.36 1535.48 1164.67 1539.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1221.9 1538.44 L1262.7 1538.44 L1262.7 1543.79 L1221.9 1543.79 L1221.9 1538.44 M1221.9 1551.43 L1262.7 1551.43 L1262.7 1556.84 L1221.9 1556.84 L1221.9 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1326.1 1546.53 L1326.1 1568.04 L1320.25 1568.04 L1320.25 1546.72 Q1320.25 1541.66 1318.27 1539.14 Q1316.3 1536.63 1312.35 1536.63 Q1307.61 1536.63 1304.87 1539.65 Q1302.14 1542.68 1302.14 1547.9 L1302.14 1568.04 L1296.25 1568.04 L1296.25 1532.4 L1302.14 1532.4 L1302.14 1537.93 Q1304.24 1534.72 1307.07 1533.13 Q1309.94 1531.54 1313.66 1531.54 Q1319.8 1531.54 1322.95 1535.36 Q1326.1 1539.14 1326.1 1546.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1359.27 1538.44 L1400.07 1538.44 L1400.07 1543.79 L1359.27 1543.79 L1359.27 1538.44 M1359.27 1551.43 L1400.07 1551.43 L1400.07 1556.84 L1359.27 1556.84 L1359.27 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M1433.62 1518.52 L1439.51 1518.52 L1439.51 1547.77 L1456.98 1532.4 L1464.46 1532.4 L1445.56 1549.07 L1465.26 1568.04 L1457.62 1568.04 L1439.51 1550.63 L1439.51 1568.04 L1433.62 1568.04 L1433.62 1518.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,1423.18 249.195,47.2441 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,1227.14 268.092,1227.14 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,977.352 268.092,977.352 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,727.563 268.092,727.563 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,477.773 268.092,477.773 "/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="249.195,227.984 268.092,227.984 "/>
<path clip-path="url(#clip540)" d="M116.668 1240.49 L124.306 1240.49 L124.306 1214.12 L115.996 1215.79 L115.996 1211.53 L124.26 1209.86 L128.936 1209.86 L128.936 1240.49 L136.575 1240.49 L136.575 1244.42 L116.668 1244.42 L116.668 1240.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M146.019 1238.54 L150.903 1238.54 L150.903 1244.42 L146.019 1244.42 L146.019 1238.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M161.135 1209.86 L179.491 1209.86 L179.491 1213.8 L165.417 1213.8 L165.417 1222.27 Q166.436 1221.92 167.454 1221.76 Q168.473 1221.57 169.491 1221.57 Q175.278 1221.57 178.658 1224.75 Q182.038 1227.92 182.038 1233.33 Q182.038 1238.91 178.565 1242.01 Q175.093 1245.09 168.774 1245.09 Q166.598 1245.09 164.329 1244.72 Q162.084 1244.35 159.677 1243.61 L159.677 1238.91 Q161.76 1240.05 163.982 1240.6 Q166.204 1241.16 168.681 1241.16 Q172.686 1241.16 175.024 1239.05 Q177.362 1236.94 177.362 1233.33 Q177.362 1229.72 175.024 1227.62 Q172.686 1225.51 168.681 1225.51 Q166.806 1225.51 164.931 1225.93 Q163.079 1226.34 161.135 1227.22 L161.135 1209.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M201.25 1212.94 Q197.639 1212.94 195.811 1216.5 Q194.005 1220.05 194.005 1227.18 Q194.005 1234.28 195.811 1237.85 Q197.639 1241.39 201.25 1241.39 Q204.885 1241.39 206.69 1237.85 Q208.519 1234.28 208.519 1227.18 Q208.519 1220.05 206.69 1216.5 Q204.885 1212.94 201.25 1212.94 M201.25 1209.24 Q207.061 1209.24 210.116 1213.84 Q213.195 1218.43 213.195 1227.18 Q213.195 1235.9 210.116 1240.51 Q207.061 1245.09 201.25 1245.09 Q195.44 1245.09 192.362 1240.51 Q189.306 1235.9 189.306 1227.18 Q189.306 1218.43 192.362 1213.84 Q195.44 1209.24 201.25 1209.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M117.663 990.697 L125.302 990.697 L125.302 964.331 L116.992 965.998 L116.992 961.739 L125.255 960.072 L129.931 960.072 L129.931 990.697 L137.57 990.697 L137.57 994.632 L117.663 994.632 L117.663 990.697 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M147.015 988.752 L151.899 988.752 L151.899 994.632 L147.015 994.632 L147.015 988.752 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M160.903 960.072 L183.126 960.072 L183.126 962.063 L170.579 994.632 L165.695 994.632 L177.501 964.007 L160.903 964.007 L160.903 960.072 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M192.292 960.072 L210.649 960.072 L210.649 964.007 L196.575 964.007 L196.575 972.479 Q197.593 972.132 198.612 971.97 Q199.63 971.785 200.649 971.785 Q206.436 971.785 209.815 974.956 Q213.195 978.127 213.195 983.544 Q213.195 989.123 209.723 992.225 Q206.25 995.303 199.931 995.303 Q197.755 995.303 195.487 994.933 Q193.241 994.563 190.834 993.822 L190.834 989.123 Q192.917 990.257 195.139 990.813 Q197.362 991.368 199.838 991.368 Q203.843 991.368 206.181 989.262 Q208.519 987.155 208.519 983.544 Q208.519 979.933 206.181 977.827 Q203.843 975.72 199.838 975.72 Q197.963 975.72 196.088 976.137 Q194.237 976.553 192.292 977.433 L192.292 960.072 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M119.885 740.907 L136.204 740.907 L136.204 744.843 L114.26 744.843 L114.26 740.907 Q116.922 738.153 121.505 733.523 Q126.112 728.871 127.292 727.528 Q129.538 725.005 130.417 723.269 Q131.32 721.509 131.32 719.82 Q131.32 717.065 129.376 715.329 Q127.455 713.593 124.353 713.593 Q122.154 713.593 119.7 714.357 Q117.269 715.121 114.492 716.672 L114.492 711.949 Q117.316 710.815 119.769 710.236 Q122.223 709.658 124.26 709.658 Q129.63 709.658 132.825 712.343 Q136.019 715.028 136.019 719.519 Q136.019 721.648 135.209 723.57 Q134.422 725.468 132.316 728.06 Q131.737 728.732 128.635 731.949 Q125.533 735.144 119.885 740.907 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M146.019 738.963 L150.903 738.963 L150.903 744.843 L146.019 744.843 L146.019 738.963 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M171.089 713.361 Q167.477 713.361 165.649 716.926 Q163.843 720.468 163.843 727.597 Q163.843 734.704 165.649 738.269 Q167.477 741.81 171.089 741.81 Q174.723 741.81 176.528 738.269 Q178.357 734.704 178.357 727.597 Q178.357 720.468 176.528 716.926 Q174.723 713.361 171.089 713.361 M171.089 709.658 Q176.899 709.658 179.954 714.264 Q183.033 718.847 183.033 727.597 Q183.033 736.324 179.954 740.931 Q176.899 745.514 171.089 745.514 Q165.278 745.514 162.2 740.931 Q159.144 736.324 159.144 727.597 Q159.144 718.847 162.2 714.264 Q165.278 709.658 171.089 709.658 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M201.25 713.361 Q197.639 713.361 195.811 716.926 Q194.005 720.468 194.005 727.597 Q194.005 734.704 195.811 738.269 Q197.639 741.81 201.25 741.81 Q204.885 741.81 206.69 738.269 Q208.519 734.704 208.519 727.597 Q208.519 720.468 206.69 716.926 Q204.885 713.361 201.25 713.361 M201.25 709.658 Q207.061 709.658 210.116 714.264 Q213.195 718.847 213.195 727.597 Q213.195 736.324 210.116 740.931 Q207.061 745.514 201.25 745.514 Q195.44 745.514 192.362 740.931 Q189.306 736.324 189.306 727.597 Q189.306 718.847 192.362 714.264 Q195.44 709.658 201.25 709.658 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M120.88 491.118 L137.2 491.118 L137.2 495.053 L115.256 495.053 L115.256 491.118 Q117.918 488.363 122.501 483.734 Q127.107 479.081 128.288 477.739 Q130.533 475.215 131.413 473.479 Q132.316 471.72 132.316 470.03 Q132.316 467.276 130.371 465.54 Q128.45 463.803 125.348 463.803 Q123.149 463.803 120.695 464.567 Q118.265 465.331 115.487 466.882 L115.487 462.16 Q118.311 461.026 120.765 460.447 Q123.218 459.868 125.255 459.868 Q130.626 459.868 133.82 462.553 Q137.015 465.239 137.015 469.729 Q137.015 471.859 136.204 473.78 Q135.417 475.678 133.311 478.271 Q132.732 478.942 129.63 482.16 Q126.529 485.354 120.88 491.118 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M147.015 489.174 L151.899 489.174 L151.899 495.053 L147.015 495.053 L147.015 489.174 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M166.112 491.118 L182.431 491.118 L182.431 495.053 L160.487 495.053 L160.487 491.118 Q163.149 488.363 167.732 483.734 Q172.339 479.081 173.519 477.739 Q175.764 475.215 176.644 473.479 Q177.547 471.72 177.547 470.03 Q177.547 467.276 175.602 465.54 Q173.681 463.803 170.579 463.803 Q168.38 463.803 165.927 464.567 Q163.496 465.331 160.718 466.882 L160.718 462.16 Q163.542 461.026 165.996 460.447 Q168.45 459.868 170.487 459.868 Q175.857 459.868 179.051 462.553 Q182.246 465.239 182.246 469.729 Q182.246 471.859 181.436 473.78 Q180.649 475.678 178.542 478.271 Q177.964 478.942 174.862 482.16 Q171.76 485.354 166.112 491.118 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M192.292 460.493 L210.649 460.493 L210.649 464.428 L196.575 464.428 L196.575 472.901 Q197.593 472.553 198.612 472.391 Q199.63 472.206 200.649 472.206 Q206.436 472.206 209.815 475.377 Q213.195 478.549 213.195 483.965 Q213.195 489.544 209.723 492.646 Q206.25 495.725 199.931 495.725 Q197.755 495.725 195.487 495.354 Q193.241 494.984 190.834 494.243 L190.834 489.544 Q192.917 490.678 195.139 491.234 Q197.362 491.789 199.838 491.789 Q203.843 491.789 206.181 489.683 Q208.519 487.576 208.519 483.965 Q208.519 480.354 206.181 478.248 Q203.843 476.141 199.838 476.141 Q197.963 476.141 196.088 476.558 Q194.237 476.975 192.292 477.854 L192.292 460.493 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M119.885 241.329 L136.204 241.329 L136.204 245.264 L114.26 245.264 L114.26 241.329 Q116.922 238.574 121.505 233.945 Q126.112 229.292 127.292 227.949 Q129.538 225.426 130.417 223.69 Q131.32 221.931 131.32 220.241 Q131.32 217.486 129.376 215.75 Q127.455 214.014 124.353 214.014 Q122.154 214.014 119.7 214.778 Q117.269 215.542 114.492 217.093 L114.492 212.371 Q117.316 211.236 119.769 210.658 Q122.223 210.079 124.26 210.079 Q129.63 210.079 132.825 212.764 Q136.019 215.449 136.019 219.94 Q136.019 222.07 135.209 223.991 Q134.422 225.889 132.316 228.482 Q131.737 229.153 128.635 232.37 Q125.533 235.565 119.885 241.329 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M146.019 239.384 L150.903 239.384 L150.903 245.264 L146.019 245.264 L146.019 239.384 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M161.135 210.704 L179.491 210.704 L179.491 214.639 L165.417 214.639 L165.417 223.111 Q166.436 222.764 167.454 222.602 Q168.473 222.417 169.491 222.417 Q175.278 222.417 178.658 225.588 Q182.038 228.759 182.038 234.176 Q182.038 239.755 178.565 242.857 Q175.093 245.935 168.774 245.935 Q166.598 245.935 164.329 245.565 Q162.084 245.194 159.677 244.454 L159.677 239.755 Q161.76 240.889 163.982 241.444 Q166.204 242 168.681 242 Q172.686 242 175.024 239.894 Q177.362 237.787 177.362 234.176 Q177.362 230.565 175.024 228.458 Q172.686 226.352 168.681 226.352 Q166.806 226.352 164.931 226.769 Q163.079 227.185 161.135 228.065 L161.135 210.704 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M201.25 213.783 Q197.639 213.783 195.811 217.347 Q194.005 220.889 194.005 228.019 Q194.005 235.125 195.811 238.69 Q197.639 242.232 201.25 242.232 Q204.885 242.232 206.69 238.69 Q208.519 235.125 208.519 228.019 Q208.519 220.889 206.69 217.347 Q204.885 213.783 201.25 213.783 M201.25 210.079 Q207.061 210.079 210.116 214.685 Q213.195 219.269 213.195 228.019 Q213.195 236.745 210.116 241.352 Q207.061 245.935 201.25 245.935 Q195.44 245.935 192.362 241.352 Q189.306 236.745 189.306 228.019 Q189.306 219.269 192.362 214.685 Q195.44 210.079 201.25 210.079 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M57.2247 850.813 L44.4614 850.813 L44.4614 861.317 L39.1779 861.317 L39.1779 844.447 L59.58 844.447 Q62.2218 848.171 63.5904 852.659 Q64.9272 857.147 64.9272 862.24 Q64.9272 873.38 58.4342 879.682 Q51.9093 885.952 40.2919 885.952 Q28.6427 885.952 22.1496 879.682 Q15.6248 873.38 15.6248 862.24 Q15.6248 857.593 16.7706 853.423 Q17.9164 849.222 20.1444 845.689 L26.9876 845.689 Q23.9639 849.254 22.4361 853.264 Q20.9083 857.274 20.9083 861.699 Q20.9083 870.42 25.7781 874.812 Q30.6479 879.172 40.2919 879.172 Q49.9041 879.172 54.7739 874.812 Q59.6436 870.42 59.6436 861.699 Q59.6436 858.293 59.0707 855.619 Q58.466 852.946 57.2247 850.813 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M16.4842 832.703 L16.4842 805.394 L21.895 805.394 L21.895 826.273 L35.8996 826.273 L35.8996 807.431 L41.3104 807.431 L41.3104 826.273 L64.0042 826.273 L64.0042 832.703 L16.4842 832.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M16.4842 795.209 L16.4842 788.779 L58.5933 788.779 L58.5933 765.64 L64.0042 765.64 L64.0042 795.209 L16.4842 795.209 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M20.8447 741.928 Q20.8447 748.93 26.0645 753.068 Q31.2844 757.174 40.2919 757.174 Q49.2675 757.174 54.4874 753.068 Q59.7073 748.93 59.7073 741.928 Q59.7073 734.926 54.4874 730.851 Q49.2675 726.746 40.2919 726.746 Q31.2844 726.746 26.0645 730.851 Q20.8447 734.926 20.8447 741.928 M15.6248 741.928 Q15.6248 731.934 22.3406 725.95 Q29.0246 719.966 40.2919 719.966 Q51.5274 719.966 58.2432 725.95 Q64.9272 731.934 64.9272 741.928 Q64.9272 751.954 58.2432 757.969 Q51.5592 763.953 40.2919 763.953 Q29.0246 763.953 22.3406 757.969 Q15.6248 751.954 15.6248 741.928 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M21.7677 703.479 L39.6235 703.479 L39.6235 695.394 Q39.6235 690.907 37.3 688.456 Q34.9765 686.005 30.6797 686.005 Q26.4147 686.005 24.0912 688.456 Q21.7677 690.907 21.7677 695.394 L21.7677 703.479 M16.4842 709.908 L16.4842 695.394 Q16.4842 687.406 20.1126 683.331 Q23.7092 679.226 30.6797 679.226 Q37.7138 679.226 41.3104 683.331 Q44.907 687.406 44.907 695.394 L44.907 703.479 L64.0042 703.479 L64.0042 709.908 L16.4842 709.908 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M29.4065 649.275 L34.9447 649.275 Q33.6716 651.758 33.035 654.431 Q32.3984 657.105 32.3984 659.969 Q32.3984 664.33 33.7352 666.526 Q35.072 668.69 37.7456 668.69 Q39.7826 668.69 40.9603 667.131 Q42.1061 665.571 43.1565 660.861 L43.6021 658.855 Q44.9389 652.617 47.3897 650.007 Q49.8086 647.365 54.1691 647.365 Q59.1344 647.365 62.0308 651.312 Q64.9272 655.227 64.9272 662.102 Q64.9272 664.966 64.3543 668.086 Q63.8132 671.173 62.6992 674.61 L56.6518 674.61 Q58.3387 671.364 59.198 668.213 Q60.0256 665.062 60.0256 661.975 Q60.0256 657.837 58.6251 655.609 Q57.1929 653.381 54.6147 653.381 Q52.2276 653.381 50.9545 655.004 Q49.6813 656.595 48.5037 662.038 L48.0262 664.075 Q46.8804 669.518 44.5251 671.937 Q42.138 674.356 38.0002 674.356 Q32.9713 674.356 30.2341 670.791 Q27.4968 667.226 27.4968 660.67 Q27.4968 657.423 27.9743 654.558 Q28.4517 651.694 29.4065 649.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M16.4842 627.632 L16.4842 622.221 L70.0516 638.772 L70.0516 644.182 L16.4842 627.632 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M18.0438 587.337 L24.314 587.337 Q22.5634 590.997 21.704 594.243 Q20.8447 597.49 20.8447 600.514 Q20.8447 605.765 22.8817 608.63 Q24.9187 611.463 28.6745 611.463 Q31.8255 611.463 33.4488 609.585 Q35.0402 607.675 36.0269 602.391 L36.8226 598.508 Q38.1912 591.315 41.6605 587.91 Q45.098 584.472 50.8908 584.472 Q57.7976 584.472 61.3624 589.119 Q64.9272 593.734 64.9272 602.678 Q64.9272 606.052 64.1633 609.871 Q63.3994 613.659 61.9035 617.733 L55.2831 617.733 Q57.4793 613.818 58.5933 610.062 Q59.7073 606.306 59.7073 602.678 Q59.7073 597.172 57.543 594.18 Q55.3786 591.188 51.3682 591.188 Q47.8671 591.188 45.8937 593.352 Q43.9204 595.485 42.9337 600.386 L42.1698 604.301 Q40.7375 611.494 37.682 614.709 Q34.6264 617.924 29.1837 617.924 Q22.8817 617.924 19.2532 613.5 Q15.6248 609.044 15.6248 601.246 Q15.6248 597.904 16.2295 594.434 Q16.8343 590.965 18.0438 587.337 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip542)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="308.73,86.1857 529.229,641.645 749.728,806.847 970.227,922.741 1190.73,930.237 1411.22,933.848 1631.72,976.788 1852.22,1384.24 2072.72,973.397 2293.22,969.922 "/>
<path clip-path="url(#clip540)" d="M1758.74 196.789 L2282.64 196.789 L2282.64 93.1086 L1758.74 93.1086  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1758.74,196.789 2282.64,196.789 2282.64,93.1086 1758.74,93.1086 1758.74,196.789 "/>
<polyline clip-path="url(#clip540)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="1782.11,144.949 1922.35,144.949 "/>
<path clip-path="url(#clip540)" d="M1966.07 141.28 Q1967.67 138.409 1969.89 137.044 Q1972.11 135.678 1975.12 135.678 Q1979.17 135.678 1981.37 138.525 Q1983.57 141.349 1983.57 146.581 L1983.57 162.229 L1979.29 162.229 L1979.29 146.719 Q1979.29 142.993 1977.97 141.187 Q1976.65 139.382 1973.94 139.382 Q1970.63 139.382 1968.71 141.581 Q1966.79 143.78 1966.79 147.576 L1966.79 162.229 L1962.51 162.229 L1962.51 146.719 Q1962.51 142.969 1961.19 141.187 Q1959.87 139.382 1957.11 139.382 Q1953.85 139.382 1951.93 141.604 Q1950.01 143.803 1950.01 147.576 L1950.01 162.229 L1945.72 162.229 L1945.72 136.303 L1950.01 136.303 L1950.01 140.331 Q1951.47 137.946 1953.5 136.812 Q1955.54 135.678 1958.34 135.678 Q1961.16 135.678 1963.13 137.113 Q1965.12 138.548 1966.07 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2002.85 164.636 Q2001.05 169.266 1999.34 170.678 Q1997.62 172.09 1994.75 172.09 L1991.35 172.09 L1991.35 168.525 L1993.85 168.525 Q1995.61 168.525 1996.58 167.692 Q1997.55 166.858 1998.73 163.756 L1999.5 161.812 L1989.01 136.303 L1993.52 136.303 L2001.63 156.581 L2009.73 136.303 L2014.24 136.303 L2002.85 164.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2037.18 148.965 Q2037.18 144.335 2035.26 141.789 Q2033.36 139.243 2029.91 139.243 Q2026.49 139.243 2024.57 141.789 Q2022.67 144.335 2022.67 148.965 Q2022.67 153.571 2024.57 156.118 Q2026.49 158.664 2029.91 158.664 Q2033.36 158.664 2035.26 156.118 Q2037.18 153.571 2037.18 148.965 M2041.44 159.011 Q2041.44 165.631 2038.5 168.849 Q2035.56 172.09 2029.5 172.09 Q2027.25 172.09 2025.26 171.742 Q2023.27 171.418 2021.4 170.724 L2021.4 166.58 Q2023.27 167.599 2025.1 168.085 Q2026.93 168.571 2028.83 168.571 Q2033.02 168.571 2035.1 166.372 Q2037.18 164.196 2037.18 159.775 L2037.18 157.668 Q2035.86 159.96 2033.8 161.094 Q2031.74 162.229 2028.87 162.229 Q2024.1 162.229 2021.19 158.594 Q2018.27 154.96 2018.27 148.965 Q2018.27 142.946 2021.19 139.312 Q2024.1 135.678 2028.87 135.678 Q2031.74 135.678 2033.8 136.812 Q2035.86 137.946 2037.18 140.238 L2037.18 136.303 L2041.44 136.303 L2041.44 159.011 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2072.39 148.201 L2072.39 150.284 L2052.81 150.284 Q2053.08 154.682 2055.45 156.997 Q2057.83 159.289 2062.07 159.289 Q2064.52 159.289 2066.81 158.687 Q2069.13 158.085 2071.39 156.881 L2071.39 160.909 Q2069.1 161.881 2066.7 162.391 Q2064.29 162.9 2061.81 162.9 Q2055.61 162.9 2051.97 159.289 Q2048.36 155.678 2048.36 149.52 Q2048.36 143.155 2051.79 139.428 Q2055.24 135.678 2061.07 135.678 Q2066.3 135.678 2069.33 139.057 Q2072.39 142.414 2072.39 148.201 M2068.13 146.951 Q2068.08 143.456 2066.16 141.372 Q2064.27 139.289 2061.12 139.289 Q2057.55 139.289 2055.4 141.303 Q2053.27 143.317 2052.95 146.974 L2068.13 146.951 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2099.57 141.28 Q2101.16 138.409 2103.39 137.044 Q2105.61 135.678 2108.62 135.678 Q2112.67 135.678 2114.87 138.525 Q2117.07 141.349 2117.07 146.581 L2117.07 162.229 L2112.78 162.229 L2112.78 146.719 Q2112.78 142.993 2111.46 141.187 Q2110.14 139.382 2107.44 139.382 Q2104.13 139.382 2102.2 141.581 Q2100.28 143.78 2100.28 147.576 L2100.28 162.229 L2096 162.229 L2096 146.719 Q2096 142.969 2094.68 141.187 Q2093.36 139.382 2090.61 139.382 Q2087.34 139.382 2085.42 141.604 Q2083.5 143.803 2083.5 147.576 L2083.5 162.229 L2079.22 162.229 L2079.22 136.303 L2083.5 136.303 L2083.5 140.331 Q2084.96 137.946 2087 136.812 Q2089.03 135.678 2091.83 135.678 Q2094.66 135.678 2096.63 137.113 Q2098.62 138.548 2099.57 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2145.75 141.28 Q2147.34 138.409 2149.57 137.044 Q2151.79 135.678 2154.8 135.678 Q2158.85 135.678 2161.05 138.525 Q2163.25 141.349 2163.25 146.581 L2163.25 162.229 L2158.96 162.229 L2158.96 146.719 Q2158.96 142.993 2157.64 141.187 Q2156.33 139.382 2153.62 139.382 Q2150.31 139.382 2148.39 141.581 Q2146.46 143.78 2146.46 147.576 L2146.46 162.229 L2142.18 162.229 L2142.18 146.719 Q2142.18 142.969 2140.86 141.187 Q2139.54 139.382 2136.79 139.382 Q2133.52 139.382 2131.6 141.604 Q2129.68 143.803 2129.68 147.576 L2129.68 162.229 L2125.4 162.229 L2125.4 136.303 L2129.68 136.303 L2129.68 140.331 Q2131.14 137.946 2133.18 136.812 Q2135.21 135.678 2138.01 135.678 Q2140.84 135.678 2142.81 137.113 Q2144.8 138.548 2145.75 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2191.44 170.099 L2191.44 173.409 L2166.81 173.409 L2166.81 170.099 L2191.44 170.099 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2195.45 136.303 L2199.7 136.303 L2199.7 162.229 L2195.45 162.229 L2195.45 136.303 M2195.45 126.21 L2199.7 126.21 L2199.7 131.604 L2195.45 131.604 L2195.45 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2208.62 136.303 L2212.88 136.303 L2212.88 162.692 Q2212.88 167.645 2210.98 169.867 Q2209.1 172.09 2204.91 172.09 L2203.29 172.09 L2203.29 168.479 L2204.43 168.479 Q2206.86 168.479 2207.74 167.344 Q2208.62 166.233 2208.62 162.692 L2208.62 136.303 M2208.62 126.21 L2212.88 126.21 L2212.88 131.604 L2208.62 131.604 L2208.62 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2225.91 158.34 L2225.91 172.09 L2221.63 172.09 L2221.63 136.303 L2225.91 136.303 L2225.91 140.238 Q2227.25 137.923 2229.29 136.812 Q2231.35 135.678 2234.19 135.678 Q2238.92 135.678 2241.86 139.428 Q2244.82 143.178 2244.82 149.289 Q2244.82 155.4 2241.86 159.15 Q2238.92 162.9 2234.19 162.9 Q2231.35 162.9 2229.29 161.789 Q2227.25 160.655 2225.91 158.34 M2240.4 149.289 Q2240.4 144.59 2238.45 141.928 Q2236.53 139.243 2233.15 139.243 Q2229.77 139.243 2227.83 141.928 Q2225.91 144.59 2225.91 149.289 Q2225.91 153.988 2227.83 156.673 Q2229.77 159.335 2233.15 159.335 Q2236.53 159.335 2238.45 156.673 Q2240.4 153.988 2240.4 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip540)" d="M2254.57 156.349 L2259.26 156.349 L2259.26 162.229 L2254.57 162.229 L2254.57 156.349 M2254.57 127.669 L2259.26 127.669 L2259.26 142.831 L2258.8 151.094 L2255.05 151.094 L2254.57 142.831 L2254.57 127.669 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
</div></div>
</div>
<section id="questions-and-observations">
<h4>Questions and observations:<a class="headerlink" href="#questions-and-observations" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Why do some orderings get better performance?</p></li>
<li><p>For both the <code class="docutils literal notranslate"><span class="pre">jpi</span></code> (Algo 2.5) and <code class="docutils literal notranslate"><span class="pre">pji</span></code> (Algo 2.4) loop orderings, the inner loop accesses columns of <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(A\)</span>. However,</p>
<ul>
<li><p>Each execution of the inner loop of the <code class="docutils literal notranslate"><span class="pre">jpi</span></code> (Algo 2.5) ordering updates the same column of <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
<li><p>Each execution of the inner loop of the <code class="docutils literal notranslate"><span class="pre">pji</span></code> (Algo 2.4) ordering updates a different column of <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These results are influenced by the fact that Julia uses <strong>column-major</strong> storing of multidimensional arrays.</p>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sdsu-comp605/spring25",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="module2-1_measuring_performance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">6) Measuring Performance</p>
      </div>
    </a>
    <a class="right-next"
       href="module2-3_blocked_mmm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8) Blocked Matrix-Matrix Multiplication</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-cpu-optimization">1. Introduction to CPU Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-matrix-multiply">1.1 Matrix-Matrix Multiply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering">2. Loop ordering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ijp">2.1 Loop ordering: ijp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ipj">2.2 Loop ordering: ipj</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pij">2.3 Loop ordering: pij</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pji">2.4 Loop ordering: pji</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jpi">2.5 Loop ordering: jpi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jip">2.6 Loop ordering: jip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-and-observations">Questions and observations:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valeria Barra
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>