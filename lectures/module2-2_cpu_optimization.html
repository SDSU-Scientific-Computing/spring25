
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7) CPU Optimization: Matrix-Matrix Multiply &#8212; Scientific Computing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/module2-2_cpu_optimization';</script>
    <link rel="icon" href="../_static/SDSU-comp605_logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8) Blocked Matrix-Matrix Multiplication" href="module2-3_blocked_mmm.html" />
    <link rel="prev" title="6) Measuring Performance" href="module2-1_measuring_performance.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-light" alt="Scientific Computing - Home"/>
    <script>document.write(`<img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-dark" alt="Scientific Computing - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../lectures.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module1-1_first_class.html">1) First Class: Reproducibility and Git</a></li>


<li class="toctree-l2"><a class="reference internal" href="module1-2_linux.html">2) The Linux Filesystem and commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-3_community_projects.html">3) Community Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-4_intro_architectures.html">4) Introduction to Computer Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-5_intro_vectorization.html">5) Introduction to Vectorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-1_measuring_performance.html">6) Measuring Performance</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">7) CPU Optimization: Matrix-Matrix Multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-3_blocked_mmm.html">8) Blocked Matrix-Matrix Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-4_packing_for_cache.html">9) Packing for cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-5_intro_multithreading.html">10) Introduction to Multithreading</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25/issues/new?title=Issue%20on%20page%20%2Flectures/module2-2_cpu_optimization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/module2-2_cpu_optimization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>7) CPU Optimization: Matrix-Matrix Multiply</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-cpu-optimization">1. Introduction to CPU Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-matrix-multiply">1.1 Matrix-Matrix Multiply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering">2. Loop ordering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ijp">2.1 Loop ordering: ijp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ipj">2.2 Loop ordering: ipj</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pij">2.3 Loop ordering: pij</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pji">2.4 Loop ordering: pji</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jpi">2.5 Loop ordering: jpi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jip">2.6 Loop ordering: jip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-and-observations">Questions and observations:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cpu-optimization-matrix-matrix-multiply">
<h1>7) CPU Optimization: Matrix-Matrix Multiply<a class="headerlink" href="#cpu-optimization-matrix-matrix-multiply" title="Link to this heading">#</a></h1>
<p>Last time:</p>
<ul class="simple">
<li><p>Measuring performance</p></li>
</ul>
<p>Today:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#introduction-to-cpu-optimization"><span class="xref myst">Introduction to CPU Optimization</span></a><br />
1.1 <a class="reference internal" href="#matrix-matrix-multiply"><span class="xref myst">Matrix-Matrix Multiply</span></a></p></li>
<li><p><a class="reference internal" href="#loop-ordering"><span class="xref myst">Loop ordering</span></a></p></li>
</ol>
<section id="introduction-to-cpu-optimization">
<h2>1. Introduction to CPU Optimization<a class="headerlink" href="#introduction-to-cpu-optimization" title="Link to this heading">#</a></h2>
<p>In this module we talk about optimizing matrix-matrix multiply on the CPU. Some of the material here is largely based on the <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/LAFF-On-PfHP.html">LAFF-On Programming for High Performance</a> of Robert van de Geijn,
Margaret Myers, Devangi Parikh, which has a pairing online MOOC: <a class="reference external" href="https://www.cs.utexas.edu/users/flame/laff/pfhp/LAFF-On-PfHP.html">LAFF-On Programming for High Performance (LAFF-On-PfHP)</a>.</p>
<p>I encourage you to watch the videos before class. When watching the videos, really you should be watching for the <em>big picture</em> and we will revisit most of the material in lecture as well, mainly you will have a better learning experience if the in class lectures are the first time you’ve seen some of the material.</p>
<p>The MOOC is done using C (not Julia), so some of the syntax and language discussion is not relevant, but the overall ideas apply.</p>
<p>Two big differences between the material presented in C Vs Julia:</p>
<ol class="arabic simple">
<li><p>Julia starts it’s indexing with <code class="docutils literal notranslate"><span class="pre">1</span></code> whereas C uses <code class="docutils literal notranslate"><span class="pre">0</span></code>, so the first element of an array <code class="docutils literal notranslate"><span class="pre">A</span></code> in Julia is:</p></li>
</ol>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>whereas in C is:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The second difference is that in C, matrices are not
really first-class objects so they must be indexed as flat vectors. In Julia, even though behind the scenes everything is a flat vector, we can index into matrices directly.</p></li>
</ol>
<p>Some additional Julia related material was gleaned from Sacha Verweij’s repository <a class="reference external" href="https://github.com/Sacha0/GemmDemo.jl">GemmDemo.jl</a> and from a former colleague, Maciej Waruszewski’s repository <a class="reference external" href="https://github.com/mwarusz/MyJuliaGEMM">MyJuliaGEMM</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Gemm in the name of the routine stands for <strong>General Matrix-Matrix multiplication</strong>. Gemm is an acronym that is widely used in scientific computing, with roots in the Basic Linear Algebra Subprograms (BLAS).</p>
</div>
<p>Why do we care about CPU optimization (and not just MPI). Again, because of this:</p>
<p><img alt="42 years of microprocessor data" src="https://www.karlrupp.net/wp-content/uploads/2018/02/42-years-processor-trend.png" /></p>
<p>Source: <a class="reference external" href="https://github.com/karlrupp/microprocessor-trend-data">Microprocessor Trend Data</a>.</p>
<blockquote>
<div><p>Related videos and texts:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=knTLy1j-rco">1.1.1 Launch, part 1</a> (time 7:51), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-launch.html">text</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=cRyVMrNNRCk">GFLOPS</a> (time: 5:31), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-launch.html">text</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=PhjildK5oO8">1.2.2  The leading dimension of a matrix</a>
(time: 4:02), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-the-leading-dimension.html">text</a>.</p></li>
</ul>
</div></blockquote>
<section id="matrix-matrix-multiply">
<h3>1.1 Matrix-Matrix Multiply<a class="headerlink" href="#matrix-matrix-multiply" title="Link to this heading">#</a></h3>
<p>We will focus on matrix-matrix multiplication:</p>
<div class="math notranslate nohighlight">
\[
C = C + A * B
\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is <span class="math notranslate nohighlight">\(m \times n\)</span>, <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(m \times k\)</span>, and <span class="math notranslate nohighlight">\(B\)</span> is <span class="math notranslate nohighlight">\(k \times n\)</span>.</p>
<p>The formula we learn for this in Linear Algebra is the following:</p>
<div class="math notranslate nohighlight">
\[
γ_{ij} = γ_{ij} + \sum_{p=1}^{k} α_{ip} β_{pj}
\]</div>
<p>where <span class="math notranslate nohighlight">\(γ_{ij}\)</span>, <span class="math notranslate nohighlight">\(α_{ip}\)</span>, and <span class="math notranslate nohighlight">\(β_{pj}\)</span> are the elements of the matrices <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(B\)</span>, respectively.</p>
<section id="notation">
<h4>Notation<a class="headerlink" href="#notation" title="Link to this heading">#</a></h4>
<p>See <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-notation.html">text 1.3.1 Notation</a>.</p>
<ul class="simple">
<li><p>Capital letters for matrices <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, etc.</p></li>
<li><p>lower case letters for vectors <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, etc.</p></li>
<li><p>lower case Greek letters for floating point scalars
<span class="math notranslate nohighlight">\(α\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(A\)</span>),
<span class="math notranslate nohighlight">\(β\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(B\)</span>),
<span class="math notranslate nohighlight">\(γ\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(C\)</span>),</p></li>
<li><p>lower case letters for integer scalars <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(k\)</span> (for matrix sizes) and <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(p\)</span> for element indices</p></li>
<li><p>Often useful to think of matrices as collections of column and/or row vectors:</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(m \times k\)</span> matrix, then we expose its columns as</p>
<div class="math notranslate nohighlight">
\[
 A = [a_1 | a_2 | \dots | a_k] 
\]</div>
<p>so that <span class="math notranslate nohighlight">\(a_j\)</span> equals the column with index <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>We can expose its rows as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A =
   \begin{bmatrix}
     \tilde{a}_{1}^{T}\\
     \tilde{a}_{2}^{T}\\
     \ddots\\
     \tilde{a}_{m}^{T}
   \end{bmatrix}
\end{split}\]</div>
<p>so that <span class="math notranslate nohighlight">\(\tilde{a}_{i}\)</span> equals the row at index <span class="math notranslate nohighlight">\(i\)</span>. Here the <span class="math notranslate nohighlight">\(^T\)</span> indicates it is a row (a column vector that has been transposed). The tilde is added for clarity since <span class="math notranslate nohighlight">\(a^T_i\)</span>  would in this setting equal the column indexed with <span class="math notranslate nohighlight">\(i\)</span> that has been transposed, rather than the row indexed with <span class="math notranslate nohighlight">\(i\)</span> or any subset of the vector. When there isn’t a cause for confusion, we will sometimes leave the tilde off.</p>
<ul class="simple">
<li><p>Note that we think of all vectors as column vectors by default.</p></li>
</ul>
</section>
</section>
</section>
<section id="loop-ordering">
<h2>2. Loop ordering<a class="headerlink" href="#loop-ordering" title="Link to this heading">#</a></h2>
<p>See <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-ordering-the-loops.html">text 1.2.4 Ordering the loops</a>.</p>
<p>When the above formula is implemented as a triply nested loop:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
</pre></div>
</div>
<p>The loop ordering does not impact the correctness of the algorithm. Each of the loop orderings can be interpreted slightly differently.</p>
<p>In the example above, we call “ijp” the loop ordering, since the loop index variables appear from outer most loop to inner most loop this way.</p>
<section id="loop-ordering-ijp">
<h3>2.1 Loop ordering: ijp<a class="headerlink" href="#loop-ordering-ijp" title="Link to this heading">#</a></h3>
<p>Row vectors of <span class="math notranslate nohighlight">\(A\)</span> times the matrix <span class="math notranslate nohighlight">\(B\)</span> (update rows of <span class="math notranslate nohighlight">\(C\)</span>):</p>
<div class="math notranslate nohighlight">
\[
  \tilde{c}_{i}^T = \tilde{c}_{i}^{T} + \tilde{a}_{i}^T B
\]</div>
<p>with inner <span class="math notranslate nohighlight">\(\tilde{a}_{i}^T B\)</span> computed using dot products (update <span class="math notranslate nohighlight">\(\gamma_{ij}\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \tilde{a}_{i}^T B =
   \begin{bmatrix}
     \tilde{a}_{i}^T b_1 &amp; \cdots &amp; \tilde{a}_{i}^T b_m
   \end{bmatrix}
\]</div>
<p><img alt="ijp loop ordering" src="../_images/ijp.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Row vectors of A times the matrix B (update rows of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ijp!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_ijp! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong>:</p>
<p>In the code above (and codes below) we have used the <code class="docutils literal notranslate"><span class="pre">&#64;inbounds</span></code> macro in Julia. This tells the compiler to avoid <a class="reference external" href="https://docs.julialang.org/en/v1/devdocs/boundscheck/">bounds checking</a> that would normally be applied to ensure program safety when accessing arrays. Use this to improve runtime performance <em>only if</em> you are extremely confident that your code might not try to access/read/write out of bounds data.</p>
</section>
<section id="loop-ordering-ipj">
<h3>2.2 Loop ordering: ipj<a class="headerlink" href="#loop-ordering-ipj" title="Link to this heading">#</a></h3>
<p>Row vectors of <span class="math notranslate nohighlight">\(A\)</span> times the matrix <span class="math notranslate nohighlight">\(B\)</span> (update rows of <span class="math notranslate nohighlight">\(C\)</span>):</p>
<div class="math notranslate nohighlight">
\[
  \tilde{c}_{i}^T = \tilde{c}_{i}^{T} + \tilde{a}_{i}^T B
\]</div>
<p>but this time with inner product <span class="math notranslate nohighlight">\(\tilde{a}_{i}^T B\)</span> computed using <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms"><code class="docutils literal notranslate"><span class="pre">axpy</span></code></a>, scalar times vector plus vector (update rows of C, <span class="math notranslate nohighlight">\(\tilde{c}_{i}^T\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \tilde{a}_{i}^T B = \sum_{p=1}^{k} \alpha_{ip} \tilde{b}_p^T
\]</div>
<p><img alt="ipj loop ordering" src="../_images/ipj.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Row vectors of A times the matrix B (update rows of `C`) with inner `axpy`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ipj!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>


<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_ipj! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-pij">
<h3>2.3 Loop ordering: pij<a class="headerlink" href="#loop-ordering-pij" title="Link to this heading">#</a></h3>
<p>Rank one update (repeatedly update all elements of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  C = C + \sum_{p=1}^{k} a_{p} \tilde{b}_{p}^T
\]</div>
<p>with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with vector <span class="math notranslate nohighlight">\(\tilde{b}_{p}^{T}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    \alpha_{1p} \tilde{b}_{p}^T\\
    \vdots\\
    \alpha_{np} \tilde{b}_{p}^T
  \end{bmatrix}
\end{split}\]</div>
<p><img alt="pij loop ordering" src="../_images/pij.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using `axpy` with rows of `B`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pij!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_pij! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-pji">
<h3>2.4 Loop ordering: pji<a class="headerlink" href="#loop-ordering-pji" title="Link to this heading">#</a></h3>
<p>Rank one update (repeatedly update all elements of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  C = C + \sum_{p=1}^{k} a_{p} \tilde{b}_{p}^T
\]</div>
<p>with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with column vector <span class="math notranslate nohighlight">\(a_{p}\)</span></p>
<div class="math notranslate nohighlight">
\[
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    a_{p} \beta_{p1} &amp; \cdots &amp; a_{p} \beta_{pm}
  \end{bmatrix}
\]</div>
<p><img alt="pji loop ordering" src="../_images/pji.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using `axpy` with columns of `A`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pji!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_pji! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-jpi">
<h3>2.5 Loop ordering: jpi<a class="headerlink" href="#loop-ordering-jpi" title="Link to this heading">#</a></h3>
<p>Matrix times column vector (update columns of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  c_j = c_{j} + A b_j
\]</div>
<p>with inner products <span class="math notranslate nohighlight">\(A b_j\)</span> computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code>:</p>
<div class="math notranslate nohighlight">
\[
  A b_j = \sum_{p=1}^{k} a_{p}\beta_{pj}
\]</div>
<p><img alt="jpi loop ordering" src="../_images/jpi.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times column vector (update columns of `C`) with inner `axpy`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jpi!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jpi! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-jip">
<h3>2.6 Loop ordering: jip<a class="headerlink" href="#loop-ordering-jip" title="Link to this heading">#</a></h3>
<p>Matrix times column vector (update columns of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  c_j = c_{j} + A b_j
\]</div>
<p>with inner products <span class="math notranslate nohighlight">\(A b_j\)</span> computed using dot products</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A b_j =
  \begin{bmatrix}
    \tilde{a}_{1}^{T} b_{j}\\
    \vdots\\
    \tilde{a}_{n}^{T} b_{j}\\
  \end{bmatrix}
\end{split}\]</div>
<p><img alt="jip loop ordering" src="../_images/jip.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jip!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jip! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h3>
<p>We now want to test all these different implementations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># What modules / packages do we depend on</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Printf</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="n">default</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c"># Plots embelishments</span>

<span class="c"># To ensure repeatability</span>
<span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">777</span><span class="p">)</span>

<span class="c"># Don&#39;t let BLAS use lots of threads (since we are not multi-threaded yet!)</span>
<span class="n">BLAS</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># C := α * A * B + β * C</span>
<span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mul!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span>

<span class="c"># Algo 2.1: matrix times row vector (update rows of `C`) with inner dot product</span>
<span class="n">mygemm!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mygemm_ijp!</span>

<span class="c"># Algo 2.2: matrix times row vector (update rows of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_ipj!</span>

<span class="c"># Algo 2.3: Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with rows of `B`</span>
<span class="c"># mygemm! = mygemm_pij!</span>

<span class="c"># Algo 2.4: Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with columns of `A`</span>
<span class="c"># mygemm! = mygemm_pji!</span>

<span class="c"># Algo 2.5: matrix times column vector (update columns of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_jpi!</span>

<span class="c"># Algo 2.6: matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="c"># mygemm! = mygemm_jip!</span>

<span class="n">num_reps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="c"># What precision numbers to use</span>
<span class="c"># FloatType = Float32</span>
<span class="n">FloatType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span>

<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;size |      reference      |           </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">)</span>
<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;     |   seconds   GFLOPS  |   seconds   GFLOPS     err</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">480</span>
<span class="n">best_perf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="c"># Size of square matrix to consider</span>
<span class="k">for</span><span class="w"> </span><span class="n">nmk</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">N</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Int</span><span class="p">(</span><span class="n">nmk</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nmk</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%4d</span><span class="s"> |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nmk</span><span class="p">)</span>

<span class="w">  </span><span class="n">gflops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-09</span>

<span class="w">  </span><span class="c"># Create the A, B, and C matrices with some random data</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Make a copy of C for resetting data later</span>
<span class="w">  </span><span class="n">C_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="w">  </span><span class="c"># The &quot;truth&quot;, to check for correctness</span>
<span class="w">  </span><span class="n">C_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span>

<span class="w">  </span><span class="c"># Compute the reference timings</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="c"># Make sure that we have the right answer!</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">C_ref</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Print the reference implementation timing</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">  |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="w">  </span><span class="c"># Compute the timing for mygemm! implementation</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Compute the error (difference between our implementation and the reference)</span>
<span class="w">  </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">C</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">C_ref</span><span class="p">,</span><span class="w"> </span><span class="nb">Inf</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Print mygemm! implementations</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">   </span><span class="si">%.2e</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">err</span><span class="p">)</span>

<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot!</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">,</span><span class="w"> </span><span class="n">xlabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m = n = k&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GFLOPs/S&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$mygemm!</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size |      reference      |           mygemm_ijp!
     |   seconds   GFLOPS  |   seconds   GFLOPS     err
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  48 |  1.39e-05    15.93  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.07e-04     2.07   7.11e-15
  96 |  4.41e-05    40.09  |  8.60e-04     2.06   1.42e-14
 144 |  1.36e-04    43.98  |  3.13e-03     1.91   3.55e-14
 192 |  3.12e-04    45.41  |  7.79e-03     1.82   3.55e-14
 240 |  5.88e-04    47.00  |  1.56e-02     1.77   5.68e-14
 288 |  1.00e-03    47.78  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2.73e-02     1.75   1.85e-13
 336 |  1.61e-03    47.10  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4.33e-02     1.75   2.13e-13
 384 |  2.35e-03    48.19  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7.76e-02     1.46   2.42e-13
 432 |  3.55e-03    45.36  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9.32e-02     1.73   2.84e-13
 480 |  4.53e-03    48.85  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.27e-01     1.74   3.41e-13
</pre></div>
</div>
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip680">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip680)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip681">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip680)" d="M219.033 1423.18 L2352.76 1423.18 L2352.76 47.2441 L219.033 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip682">
    <rect x="219" y="47" width="2135" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="521.72,1423.18 521.72,47.2441 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="987.68,1423.18 987.68,47.2441 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1453.64,1423.18 1453.64,47.2441 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1919.6,1423.18 1919.6,47.2441 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.033,1296 2352.76,1296 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.033,1083.73 2352.76,1083.73 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.033,871.465 2352.76,871.465 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.033,659.196 2352.76,659.196 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.033,446.927 2352.76,446.927 "/>
<polyline clip-path="url(#clip682)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="219.033,234.658 2352.76,234.658 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="521.72,1423.18 521.72,1404.28 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="987.68,1423.18 987.68,1404.28 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1453.64,1423.18 1453.64,1404.28 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1919.6,1423.18 1919.6,1404.28 "/>
<path clip-path="url(#clip680)" d="M481.327 1481.64 L488.966 1481.64 L488.966 1455.28 L480.656 1456.95 L480.656 1452.69 L488.92 1451.02 L493.596 1451.02 L493.596 1481.64 L501.234 1481.64 L501.234 1485.58 L481.327 1485.58 L481.327 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M520.679 1454.1 Q517.068 1454.1 515.239 1457.66 Q513.433 1461.2 513.433 1468.33 Q513.433 1475.44 515.239 1479.01 Q517.068 1482.55 520.679 1482.55 Q524.313 1482.55 526.119 1479.01 Q527.947 1475.44 527.947 1468.33 Q527.947 1461.2 526.119 1457.66 Q524.313 1454.1 520.679 1454.1 M520.679 1450.39 Q526.489 1450.39 529.544 1455 Q532.623 1459.58 532.623 1468.33 Q532.623 1477.06 529.544 1481.67 Q526.489 1486.25 520.679 1486.25 Q514.869 1486.25 511.79 1481.67 Q508.734 1477.06 508.734 1468.33 Q508.734 1459.58 511.79 1455 Q514.869 1450.39 520.679 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M550.841 1454.1 Q547.23 1454.1 545.401 1457.66 Q543.595 1461.2 543.595 1468.33 Q543.595 1475.44 545.401 1479.01 Q547.23 1482.55 550.841 1482.55 Q554.475 1482.55 556.28 1479.01 Q558.109 1475.44 558.109 1468.33 Q558.109 1461.2 556.28 1457.66 Q554.475 1454.1 550.841 1454.1 M550.841 1450.39 Q556.651 1450.39 559.706 1455 Q562.785 1459.58 562.785 1468.33 Q562.785 1477.06 559.706 1481.67 Q556.651 1486.25 550.841 1486.25 Q545.03 1486.25 541.952 1481.67 Q538.896 1477.06 538.896 1468.33 Q538.896 1459.58 541.952 1455 Q545.03 1450.39 550.841 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M951.372 1481.64 L967.692 1481.64 L967.692 1485.58 L945.748 1485.58 L945.748 1481.64 Q948.41 1478.89 952.993 1474.26 Q957.599 1469.61 958.78 1468.27 Q961.025 1465.74 961.905 1464.01 Q962.808 1462.25 962.808 1460.56 Q962.808 1457.8 960.863 1456.07 Q958.942 1454.33 955.84 1454.33 Q953.641 1454.33 951.187 1455.09 Q948.757 1455.86 945.979 1457.41 L945.979 1452.69 Q948.803 1451.55 951.257 1450.97 Q953.71 1450.39 955.747 1450.39 Q961.118 1450.39 964.312 1453.08 Q967.507 1455.77 967.507 1460.26 Q967.507 1462.39 966.696 1464.31 Q965.909 1466.2 963.803 1468.8 Q963.224 1469.47 960.122 1472.69 Q957.021 1475.88 951.372 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M987.507 1454.1 Q983.895 1454.1 982.067 1457.66 Q980.261 1461.2 980.261 1468.33 Q980.261 1475.44 982.067 1479.01 Q983.895 1482.55 987.507 1482.55 Q991.141 1482.55 992.946 1479.01 Q994.775 1475.44 994.775 1468.33 Q994.775 1461.2 992.946 1457.66 Q991.141 1454.1 987.507 1454.1 M987.507 1450.39 Q993.317 1450.39 996.372 1455 Q999.451 1459.58 999.451 1468.33 Q999.451 1477.06 996.372 1481.67 Q993.317 1486.25 987.507 1486.25 Q981.696 1486.25 978.618 1481.67 Q975.562 1477.06 975.562 1468.33 Q975.562 1459.58 978.618 1455 Q981.696 1450.39 987.507 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1017.67 1454.1 Q1014.06 1454.1 1012.23 1457.66 Q1010.42 1461.2 1010.42 1468.33 Q1010.42 1475.44 1012.23 1479.01 Q1014.06 1482.55 1017.67 1482.55 Q1021.3 1482.55 1023.11 1479.01 Q1024.94 1475.44 1024.94 1468.33 Q1024.94 1461.2 1023.11 1457.66 Q1021.3 1454.1 1017.67 1454.1 M1017.67 1450.39 Q1023.48 1450.39 1026.53 1455 Q1029.61 1459.58 1029.61 1468.33 Q1029.61 1477.06 1026.53 1481.67 Q1023.48 1486.25 1017.67 1486.25 Q1011.86 1486.25 1008.78 1481.67 Q1005.72 1477.06 1005.72 1468.33 Q1005.72 1459.58 1008.78 1455 Q1011.86 1450.39 1017.67 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1427.4 1466.95 Q1430.76 1467.66 1432.63 1469.93 Q1434.53 1472.2 1434.53 1475.53 Q1434.53 1480.65 1431.01 1483.45 Q1427.49 1486.25 1421.01 1486.25 Q1418.84 1486.25 1416.52 1485.81 Q1414.23 1485.39 1411.78 1484.54 L1411.78 1480.02 Q1413.72 1481.16 1416.04 1481.74 Q1418.35 1482.32 1420.87 1482.32 Q1425.27 1482.32 1427.56 1480.58 Q1429.88 1478.84 1429.88 1475.53 Q1429.88 1472.48 1427.73 1470.77 Q1425.6 1469.03 1421.78 1469.03 L1417.75 1469.03 L1417.75 1465.19 L1421.96 1465.19 Q1425.41 1465.19 1427.24 1463.82 Q1429.07 1462.43 1429.07 1459.84 Q1429.07 1457.18 1427.17 1455.77 Q1425.3 1454.33 1421.78 1454.33 Q1419.86 1454.33 1417.66 1454.75 Q1415.46 1455.16 1412.82 1456.04 L1412.82 1451.88 Q1415.48 1451.14 1417.8 1450.77 Q1420.13 1450.39 1422.19 1450.39 Q1427.52 1450.39 1430.62 1452.83 Q1433.72 1455.23 1433.72 1459.35 Q1433.72 1462.22 1432.08 1464.21 Q1430.43 1466.18 1427.4 1466.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1453.4 1454.1 Q1449.79 1454.1 1447.96 1457.66 Q1446.15 1461.2 1446.15 1468.33 Q1446.15 1475.44 1447.96 1479.01 Q1449.79 1482.55 1453.4 1482.55 Q1457.03 1482.55 1458.84 1479.01 Q1460.67 1475.44 1460.67 1468.33 Q1460.67 1461.2 1458.84 1457.66 Q1457.03 1454.1 1453.4 1454.1 M1453.4 1450.39 Q1459.21 1450.39 1462.26 1455 Q1465.34 1459.58 1465.34 1468.33 Q1465.34 1477.06 1462.26 1481.67 Q1459.21 1486.25 1453.4 1486.25 Q1447.59 1486.25 1444.51 1481.67 Q1441.45 1477.06 1441.45 1468.33 Q1441.45 1459.58 1444.51 1455 Q1447.59 1450.39 1453.4 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1483.56 1454.1 Q1479.95 1454.1 1478.12 1457.66 Q1476.31 1461.2 1476.31 1468.33 Q1476.31 1475.44 1478.12 1479.01 Q1479.95 1482.55 1483.56 1482.55 Q1487.19 1482.55 1489 1479.01 Q1490.83 1475.44 1490.83 1468.33 Q1490.83 1461.2 1489 1457.66 Q1487.19 1454.1 1483.56 1454.1 M1483.56 1450.39 Q1489.37 1450.39 1492.42 1455 Q1495.5 1459.58 1495.5 1468.33 Q1495.5 1477.06 1492.42 1481.67 Q1489.37 1486.25 1483.56 1486.25 Q1477.75 1486.25 1474.67 1481.67 Q1471.61 1477.06 1471.61 1468.33 Q1471.61 1459.58 1474.67 1455 Q1477.75 1450.39 1483.56 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1892.69 1455.09 L1880.88 1473.54 L1892.69 1473.54 L1892.69 1455.09 M1891.46 1451.02 L1897.34 1451.02 L1897.34 1473.54 L1902.27 1473.54 L1902.27 1477.43 L1897.34 1477.43 L1897.34 1485.58 L1892.69 1485.58 L1892.69 1477.43 L1877.09 1477.43 L1877.09 1472.92 L1891.46 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1920 1454.1 Q1916.39 1454.1 1914.57 1457.66 Q1912.76 1461.2 1912.76 1468.33 Q1912.76 1475.44 1914.57 1479.01 Q1916.39 1482.55 1920 1482.55 Q1923.64 1482.55 1925.44 1479.01 Q1927.27 1475.44 1927.27 1468.33 Q1927.27 1461.2 1925.44 1457.66 Q1923.64 1454.1 1920 1454.1 M1920 1450.39 Q1925.81 1450.39 1928.87 1455 Q1931.95 1459.58 1931.95 1468.33 Q1931.95 1477.06 1928.87 1481.67 Q1925.81 1486.25 1920 1486.25 Q1914.19 1486.25 1911.12 1481.67 Q1908.06 1477.06 1908.06 1468.33 Q1908.06 1459.58 1911.12 1455 Q1914.19 1450.39 1920 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1950.17 1454.1 Q1946.56 1454.1 1944.73 1457.66 Q1942.92 1461.2 1942.92 1468.33 Q1942.92 1475.44 1944.73 1479.01 Q1946.56 1482.55 1950.17 1482.55 Q1953.8 1482.55 1955.61 1479.01 Q1957.44 1475.44 1957.44 1468.33 Q1957.44 1461.2 1955.61 1457.66 Q1953.8 1454.1 1950.17 1454.1 M1950.17 1450.39 Q1955.98 1450.39 1959.03 1455 Q1962.11 1459.58 1962.11 1468.33 Q1962.11 1477.06 1959.03 1481.67 Q1955.98 1486.25 1950.17 1486.25 Q1944.36 1486.25 1941.28 1481.67 Q1938.22 1477.06 1938.22 1468.33 Q1938.22 1459.58 1941.28 1455 Q1944.36 1450.39 1950.17 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1149.59 1539.24 Q1151.78 1535.29 1154.84 1533.41 Q1157.9 1531.54 1162.03 1531.54 Q1167.6 1531.54 1170.63 1535.45 Q1173.65 1539.33 1173.65 1546.53 L1173.65 1568.04 L1167.76 1568.04 L1167.76 1546.72 Q1167.76 1541.59 1165.95 1539.11 Q1164.13 1536.63 1160.41 1536.63 Q1155.86 1536.63 1153.22 1539.65 Q1150.58 1542.68 1150.58 1547.9 L1150.58 1568.04 L1144.69 1568.04 L1144.69 1546.72 Q1144.69 1541.56 1142.87 1539.11 Q1141.06 1536.63 1137.27 1536.63 Q1132.78 1536.63 1130.14 1539.68 Q1127.5 1542.71 1127.5 1547.9 L1127.5 1568.04 L1121.61 1568.04 L1121.61 1532.4 L1127.5 1532.4 L1127.5 1537.93 Q1129.5 1534.66 1132.31 1533.1 Q1135.11 1531.54 1138.96 1531.54 Q1142.84 1531.54 1145.55 1533.51 Q1148.28 1535.48 1149.59 1539.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1206.82 1538.44 L1247.62 1538.44 L1247.62 1543.79 L1206.82 1543.79 L1206.82 1538.44 M1206.82 1551.43 L1247.62 1551.43 L1247.62 1556.84 L1206.82 1556.84 L1206.82 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1311.02 1546.53 L1311.02 1568.04 L1305.17 1568.04 L1305.17 1546.72 Q1305.17 1541.66 1303.19 1539.14 Q1301.22 1536.63 1297.27 1536.63 Q1292.53 1536.63 1289.79 1539.65 Q1287.06 1542.68 1287.06 1547.9 L1287.06 1568.04 L1281.17 1568.04 L1281.17 1532.4 L1287.06 1532.4 L1287.06 1537.93 Q1289.16 1534.72 1291.99 1533.13 Q1294.85 1531.54 1298.58 1531.54 Q1304.72 1531.54 1307.87 1535.36 Q1311.02 1539.14 1311.02 1546.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1344.19 1538.44 L1384.99 1538.44 L1384.99 1543.79 L1344.19 1543.79 L1344.19 1538.44 M1344.19 1551.43 L1384.99 1551.43 L1384.99 1556.84 L1344.19 1556.84 L1344.19 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M1418.54 1518.52 L1424.43 1518.52 L1424.43 1547.77 L1441.9 1532.4 L1449.38 1532.4 L1430.48 1549.07 L1450.18 1568.04 L1442.54 1568.04 L1424.43 1550.63 L1424.43 1568.04 L1418.54 1568.04 L1418.54 1518.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,1423.18 219.033,47.2441 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,1296 237.931,1296 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,1083.73 237.931,1083.73 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,871.465 237.931,871.465 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,659.196 237.931,659.196 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,446.927 237.931,446.927 "/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="219.033,234.658 237.931,234.658 "/>
<path clip-path="url(#clip680)" d="M117.663 1309.35 L125.302 1309.35 L125.302 1282.98 L116.992 1284.65 L116.992 1280.39 L125.255 1278.72 L129.931 1278.72 L129.931 1309.35 L137.57 1309.35 L137.57 1313.28 L117.663 1313.28 L117.663 1309.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M147.015 1307.4 L151.899 1307.4 L151.899 1313.28 L147.015 1313.28 L147.015 1307.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M162.13 1278.72 L180.487 1278.72 L180.487 1282.66 L166.413 1282.66 L166.413 1291.13 Q167.431 1290.78 168.45 1290.62 Q169.468 1290.44 170.487 1290.44 Q176.274 1290.44 179.653 1293.61 Q183.033 1296.78 183.033 1302.2 Q183.033 1307.77 179.561 1310.88 Q176.089 1313.96 169.769 1313.96 Q167.593 1313.96 165.325 1313.58 Q163.079 1313.21 160.672 1312.47 L160.672 1307.77 Q162.755 1308.91 164.977 1309.46 Q167.2 1310.02 169.677 1310.02 Q173.681 1310.02 176.019 1307.91 Q178.357 1305.81 178.357 1302.2 Q178.357 1298.58 176.019 1296.48 Q173.681 1294.37 169.677 1294.37 Q167.802 1294.37 165.927 1294.79 Q164.075 1295.21 162.13 1296.08 L162.13 1278.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M116.506 1097.08 L124.144 1097.08 L124.144 1070.71 L115.834 1072.38 L115.834 1068.12 L124.098 1066.45 L128.774 1066.45 L128.774 1097.08 L136.413 1097.08 L136.413 1101.01 L116.506 1101.01 L116.506 1097.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M145.857 1095.13 L150.741 1095.13 L150.741 1101.01 L145.857 1101.01 L145.857 1095.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M171.505 1081.87 Q168.357 1081.87 166.505 1084.02 Q164.677 1086.18 164.677 1089.93 Q164.677 1093.65 166.505 1095.83 Q168.357 1097.98 171.505 1097.98 Q174.653 1097.98 176.482 1095.83 Q178.334 1093.65 178.334 1089.93 Q178.334 1086.18 176.482 1084.02 Q174.653 1081.87 171.505 1081.87 M180.788 1067.22 L180.788 1071.48 Q179.028 1070.64 177.223 1070.2 Q175.44 1069.76 173.681 1069.76 Q169.052 1069.76 166.598 1072.89 Q164.167 1076.01 163.82 1082.33 Q165.186 1080.32 167.246 1079.26 Q169.306 1078.17 171.783 1078.17 Q176.991 1078.17 180.001 1081.34 Q183.033 1084.49 183.033 1089.93 Q183.033 1095.25 179.885 1098.47 Q176.737 1101.69 171.505 1101.69 Q165.51 1101.69 162.339 1097.1 Q159.167 1092.5 159.167 1083.77 Q159.167 1075.57 163.056 1070.71 Q166.945 1065.83 173.496 1065.83 Q175.255 1065.83 177.038 1066.18 Q178.843 1066.52 180.788 1067.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M117.57 884.81 L125.209 884.81 L125.209 858.445 L116.899 860.111 L116.899 855.852 L125.163 854.185 L129.839 854.185 L129.839 884.81 L137.478 884.81 L137.478 888.745 L117.57 888.745 L117.57 884.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M146.922 882.866 L151.806 882.866 L151.806 888.745 L146.922 888.745 L146.922 882.866 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M160.811 854.185 L183.033 854.185 L183.033 856.176 L170.487 888.745 L165.602 888.745 L177.408 858.121 L160.811 858.121 L160.811 854.185 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M116.76 672.541 L124.399 672.541 L124.399 646.175 L116.089 647.842 L116.089 643.583 L124.353 641.916 L129.029 641.916 L129.029 672.541 L136.667 672.541 L136.667 676.476 L116.76 676.476 L116.76 672.541 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M146.112 670.597 L150.996 670.597 L150.996 676.476 L146.112 676.476 L146.112 670.597 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M171.181 660.064 Q167.848 660.064 165.927 661.847 Q164.028 663.629 164.028 666.754 Q164.028 669.879 165.927 671.661 Q167.848 673.444 171.181 673.444 Q174.514 673.444 176.436 671.661 Q178.357 669.856 178.357 666.754 Q178.357 663.629 176.436 661.847 Q174.538 660.064 171.181 660.064 M166.505 658.074 Q163.496 657.333 161.806 655.273 Q160.14 653.212 160.14 650.25 Q160.14 646.106 163.079 643.699 Q166.042 641.291 171.181 641.291 Q176.343 641.291 179.283 643.699 Q182.223 646.106 182.223 650.25 Q182.223 653.212 180.533 655.273 Q178.866 657.333 175.88 658.074 Q179.26 658.861 181.135 661.152 Q183.033 663.444 183.033 666.754 Q183.033 671.777 179.954 674.462 Q176.899 677.148 171.181 677.148 Q165.464 677.148 162.385 674.462 Q159.329 671.777 159.329 666.754 Q159.329 663.444 161.227 661.152 Q163.126 658.861 166.505 658.074 M164.792 650.689 Q164.792 653.374 166.459 654.879 Q168.149 656.384 171.181 656.384 Q174.19 656.384 175.88 654.879 Q177.593 653.374 177.593 650.689 Q177.593 648.004 175.88 646.5 Q174.19 644.995 171.181 644.995 Q168.149 644.995 166.459 646.5 Q164.792 648.004 164.792 650.689 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M116.853 460.272 L124.492 460.272 L124.492 433.906 L116.181 435.573 L116.181 431.314 L124.445 429.647 L129.121 429.647 L129.121 460.272 L136.76 460.272 L136.76 464.207 L116.853 464.207 L116.853 460.272 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M146.204 458.327 L151.089 458.327 L151.089 464.207 L146.204 464.207 L146.204 458.327 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M161.413 463.489 L161.413 459.23 Q163.172 460.064 164.977 460.503 Q166.783 460.943 168.519 460.943 Q173.149 460.943 175.579 457.841 Q178.033 454.716 178.38 448.374 Q177.038 450.365 174.977 451.429 Q172.917 452.494 170.417 452.494 Q165.232 452.494 162.2 449.369 Q159.19 446.221 159.19 440.781 Q159.19 435.457 162.339 432.24 Q165.487 429.022 170.718 429.022 Q176.714 429.022 179.862 433.629 Q183.033 438.212 183.033 446.962 Q183.033 455.133 179.144 460.017 Q175.278 464.878 168.727 464.878 Q166.968 464.878 165.163 464.531 Q163.357 464.184 161.413 463.489 M170.718 448.837 Q173.866 448.837 175.695 446.684 Q177.547 444.531 177.547 440.781 Q177.547 437.054 175.695 434.902 Q173.866 432.726 170.718 432.726 Q167.57 432.726 165.718 434.902 Q163.89 437.054 163.89 440.781 Q163.89 444.531 165.718 446.684 Q167.57 448.837 170.718 448.837 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M119.885 248.003 L136.204 248.003 L136.204 251.938 L114.26 251.938 L114.26 248.003 Q116.922 245.248 121.505 240.618 Q126.112 235.966 127.292 234.623 Q129.538 232.1 130.417 230.364 Q131.32 228.605 131.32 226.915 Q131.32 224.16 129.376 222.424 Q127.455 220.688 124.353 220.688 Q122.154 220.688 119.7 221.452 Q117.269 222.216 114.492 223.767 L114.492 219.045 Q117.316 217.91 119.769 217.332 Q122.223 216.753 124.26 216.753 Q129.63 216.753 132.825 219.438 Q136.019 222.123 136.019 226.614 Q136.019 228.744 135.209 230.665 Q134.422 232.563 132.316 235.156 Q131.737 235.827 128.635 239.044 Q125.533 242.239 119.885 248.003 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M146.019 246.058 L150.903 246.058 L150.903 251.938 L146.019 251.938 L146.019 246.058 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M171.089 220.457 Q167.477 220.457 165.649 224.021 Q163.843 227.563 163.843 234.693 Q163.843 241.799 165.649 245.364 Q167.477 248.905 171.089 248.905 Q174.723 248.905 176.528 245.364 Q178.357 241.799 178.357 234.693 Q178.357 227.563 176.528 224.021 Q174.723 220.457 171.089 220.457 M171.089 216.753 Q176.899 216.753 179.954 221.359 Q183.033 225.943 183.033 234.693 Q183.033 243.419 179.954 248.026 Q176.899 252.609 171.089 252.609 Q165.278 252.609 162.2 248.026 Q159.144 243.419 159.144 234.693 Q159.144 225.943 162.2 221.359 Q165.278 216.753 171.089 216.753 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M57.2247 850.813 L44.4614 850.813 L44.4614 861.317 L39.1779 861.317 L39.1779 844.447 L59.58 844.447 Q62.2218 848.171 63.5904 852.659 Q64.9272 857.147 64.9272 862.24 Q64.9272 873.38 58.4342 879.682 Q51.9093 885.952 40.2919 885.952 Q28.6427 885.952 22.1496 879.682 Q15.6248 873.38 15.6248 862.24 Q15.6248 857.593 16.7706 853.423 Q17.9164 849.222 20.1444 845.689 L26.9876 845.689 Q23.9639 849.254 22.4361 853.264 Q20.9083 857.274 20.9083 861.699 Q20.9083 870.42 25.7781 874.812 Q30.6479 879.172 40.2919 879.172 Q49.9041 879.172 54.7739 874.812 Q59.6436 870.42 59.6436 861.699 Q59.6436 858.293 59.0707 855.619 Q58.466 852.946 57.2247 850.813 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M16.4842 832.703 L16.4842 805.394 L21.895 805.394 L21.895 826.273 L35.8996 826.273 L35.8996 807.431 L41.3104 807.431 L41.3104 826.273 L64.0042 826.273 L64.0042 832.703 L16.4842 832.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M16.4842 795.209 L16.4842 788.779 L58.5933 788.779 L58.5933 765.64 L64.0042 765.64 L64.0042 795.209 L16.4842 795.209 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M20.8447 741.928 Q20.8447 748.93 26.0645 753.068 Q31.2844 757.174 40.2919 757.174 Q49.2675 757.174 54.4874 753.068 Q59.7073 748.93 59.7073 741.928 Q59.7073 734.926 54.4874 730.851 Q49.2675 726.746 40.2919 726.746 Q31.2844 726.746 26.0645 730.851 Q20.8447 734.926 20.8447 741.928 M15.6248 741.928 Q15.6248 731.934 22.3406 725.95 Q29.0246 719.966 40.2919 719.966 Q51.5274 719.966 58.2432 725.95 Q64.9272 731.934 64.9272 741.928 Q64.9272 751.954 58.2432 757.969 Q51.5592 763.953 40.2919 763.953 Q29.0246 763.953 22.3406 757.969 Q15.6248 751.954 15.6248 741.928 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M21.7677 703.479 L39.6235 703.479 L39.6235 695.394 Q39.6235 690.907 37.3 688.456 Q34.9765 686.005 30.6797 686.005 Q26.4147 686.005 24.0912 688.456 Q21.7677 690.907 21.7677 695.394 L21.7677 703.479 M16.4842 709.908 L16.4842 695.394 Q16.4842 687.406 20.1126 683.331 Q23.7092 679.226 30.6797 679.226 Q37.7138 679.226 41.3104 683.331 Q44.907 687.406 44.907 695.394 L44.907 703.479 L64.0042 703.479 L64.0042 709.908 L16.4842 709.908 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M29.4065 649.275 L34.9447 649.275 Q33.6716 651.758 33.035 654.431 Q32.3984 657.105 32.3984 659.969 Q32.3984 664.33 33.7352 666.526 Q35.072 668.69 37.7456 668.69 Q39.7826 668.69 40.9603 667.131 Q42.1061 665.571 43.1565 660.861 L43.6021 658.855 Q44.9389 652.617 47.3897 650.007 Q49.8086 647.365 54.1691 647.365 Q59.1344 647.365 62.0308 651.312 Q64.9272 655.227 64.9272 662.102 Q64.9272 664.966 64.3543 668.086 Q63.8132 671.173 62.6992 674.61 L56.6518 674.61 Q58.3387 671.364 59.198 668.213 Q60.0256 665.062 60.0256 661.975 Q60.0256 657.837 58.6251 655.609 Q57.1929 653.381 54.6147 653.381 Q52.2276 653.381 50.9545 655.004 Q49.6813 656.595 48.5037 662.038 L48.0262 664.075 Q46.8804 669.518 44.5251 671.937 Q42.138 674.356 38.0002 674.356 Q32.9713 674.356 30.2341 670.791 Q27.4968 667.226 27.4968 660.67 Q27.4968 657.423 27.9743 654.558 Q28.4517 651.694 29.4065 649.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M16.4842 627.632 L16.4842 622.221 L70.0516 638.772 L70.0516 644.182 L16.4842 627.632 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M18.0438 587.337 L24.314 587.337 Q22.5634 590.997 21.704 594.243 Q20.8447 597.49 20.8447 600.514 Q20.8447 605.765 22.8817 608.63 Q24.9187 611.463 28.6745 611.463 Q31.8255 611.463 33.4488 609.585 Q35.0402 607.675 36.0269 602.391 L36.8226 598.508 Q38.1912 591.315 41.6605 587.91 Q45.098 584.472 50.8908 584.472 Q57.7976 584.472 61.3624 589.119 Q64.9272 593.734 64.9272 602.678 Q64.9272 606.052 64.1633 609.871 Q63.3994 613.659 61.9035 617.733 L55.2831 617.733 Q57.4793 613.818 58.5933 610.062 Q59.7073 606.306 59.7073 602.678 Q59.7073 597.172 57.543 594.18 Q55.3786 591.188 51.3682 591.188 Q47.8671 591.188 45.8937 593.352 Q43.9204 595.485 42.9337 600.386 L42.1698 604.301 Q40.7375 611.494 37.682 614.709 Q34.6264 617.924 29.1837 617.924 Q22.8817 617.924 19.2532 613.5 Q15.6248 609.044 15.6248 601.246 Q15.6248 597.904 16.2295 594.434 Q16.8343 590.965 18.0438 587.337 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip682)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="279.421,86.1857 503.082,112.396 726.743,427.831 950.403,623.033 1174.06,724.952 1397.72,759.422 1621.39,764.104 1845.05,1384.24 2068.71,805.71 2292.37,779.684 "/>
<path clip-path="url(#clip680)" d="M1754.72 196.789 L2281.63 196.789 L2281.63 93.1086 L1754.72 93.1086  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip680)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.72,196.789 2281.63,196.789 2281.63,93.1086 1754.72,93.1086 1754.72,196.789 "/>
<polyline clip-path="url(#clip680)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="1778.43,144.949 1920.68,144.949 "/>
<path clip-path="url(#clip680)" d="M1964.73 141.28 Q1966.33 138.409 1968.55 137.044 Q1970.77 135.678 1973.78 135.678 Q1977.83 135.678 1980.03 138.525 Q1982.23 141.349 1982.23 146.581 L1982.23 162.229 L1977.95 162.229 L1977.95 146.719 Q1977.95 142.993 1976.63 141.187 Q1975.31 139.382 1972.6 139.382 Q1969.29 139.382 1967.37 141.581 Q1965.45 143.78 1965.45 147.576 L1965.45 162.229 L1961.17 162.229 L1961.17 146.719 Q1961.17 142.969 1959.85 141.187 Q1958.53 139.382 1955.77 139.382 Q1952.51 139.382 1950.59 141.604 Q1948.67 143.803 1948.67 147.576 L1948.67 162.229 L1944.38 162.229 L1944.38 136.303 L1948.67 136.303 L1948.67 140.331 Q1950.12 137.946 1952.16 136.812 Q1954.2 135.678 1957 135.678 Q1959.82 135.678 1961.79 137.113 Q1963.78 138.548 1964.73 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2001.51 164.636 Q1999.71 169.266 1997.99 170.678 Q1996.28 172.09 1993.41 172.09 L1990.01 172.09 L1990.01 168.525 L1992.51 168.525 Q1994.27 168.525 1995.24 167.692 Q1996.21 166.858 1997.39 163.756 L1998.16 161.812 L1987.67 136.303 L1992.18 136.303 L2000.29 156.581 L2008.39 136.303 L2012.9 136.303 L2001.51 164.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2035.84 148.965 Q2035.84 144.335 2033.92 141.789 Q2032.02 139.243 2028.57 139.243 Q2025.15 139.243 2023.23 141.789 Q2021.33 144.335 2021.33 148.965 Q2021.33 153.571 2023.23 156.118 Q2025.15 158.664 2028.57 158.664 Q2032.02 158.664 2033.92 156.118 Q2035.84 153.571 2035.84 148.965 M2040.1 159.011 Q2040.1 165.631 2037.16 168.849 Q2034.22 172.09 2028.16 172.09 Q2025.91 172.09 2023.92 171.742 Q2021.93 171.418 2020.05 170.724 L2020.05 166.58 Q2021.93 167.599 2023.76 168.085 Q2025.59 168.571 2027.49 168.571 Q2031.67 168.571 2033.76 166.372 Q2035.84 164.196 2035.84 159.775 L2035.84 157.668 Q2034.52 159.96 2032.46 161.094 Q2030.4 162.229 2027.53 162.229 Q2022.76 162.229 2019.85 158.594 Q2016.93 154.96 2016.93 148.965 Q2016.93 142.946 2019.85 139.312 Q2022.76 135.678 2027.53 135.678 Q2030.4 135.678 2032.46 136.812 Q2034.52 137.946 2035.84 140.238 L2035.84 136.303 L2040.1 136.303 L2040.1 159.011 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2071.05 148.201 L2071.05 150.284 L2051.47 150.284 Q2051.74 154.682 2054.11 156.997 Q2056.49 159.289 2060.73 159.289 Q2063.18 159.289 2065.47 158.687 Q2067.79 158.085 2070.05 156.881 L2070.05 160.909 Q2067.76 161.881 2065.36 162.391 Q2062.95 162.9 2060.47 162.9 Q2054.27 162.9 2050.63 159.289 Q2047.02 155.678 2047.02 149.52 Q2047.02 143.155 2050.45 139.428 Q2053.9 135.678 2059.73 135.678 Q2064.96 135.678 2067.99 139.057 Q2071.05 142.414 2071.05 148.201 M2066.79 146.951 Q2066.74 143.456 2064.82 141.372 Q2062.92 139.289 2059.78 139.289 Q2056.21 139.289 2054.06 141.303 Q2051.93 143.317 2051.61 146.974 L2066.79 146.951 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2098.23 141.28 Q2099.82 138.409 2102.04 137.044 Q2104.27 135.678 2107.28 135.678 Q2111.33 135.678 2113.53 138.525 Q2115.73 141.349 2115.73 146.581 L2115.73 162.229 L2111.44 162.229 L2111.44 146.719 Q2111.44 142.993 2110.12 141.187 Q2108.8 139.382 2106.1 139.382 Q2102.79 139.382 2100.86 141.581 Q2098.94 143.78 2098.94 147.576 L2098.94 162.229 L2094.66 162.229 L2094.66 146.719 Q2094.66 142.969 2093.34 141.187 Q2092.02 139.382 2089.27 139.382 Q2086 139.382 2084.08 141.604 Q2082.16 143.803 2082.16 147.576 L2082.16 162.229 L2077.88 162.229 L2077.88 136.303 L2082.16 136.303 L2082.16 140.331 Q2083.62 137.946 2085.66 136.812 Q2087.69 135.678 2090.49 135.678 Q2093.32 135.678 2095.29 137.113 Q2097.28 138.548 2098.23 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2144.41 141.28 Q2146 138.409 2148.23 137.044 Q2150.45 135.678 2153.46 135.678 Q2157.51 135.678 2159.71 138.525 Q2161.91 141.349 2161.91 146.581 L2161.91 162.229 L2157.62 162.229 L2157.62 146.719 Q2157.62 142.993 2156.3 141.187 Q2154.98 139.382 2152.28 139.382 Q2148.97 139.382 2147.04 141.581 Q2145.12 143.78 2145.12 147.576 L2145.12 162.229 L2140.84 162.229 L2140.84 146.719 Q2140.84 142.969 2139.52 141.187 Q2138.2 139.382 2135.45 139.382 Q2132.18 139.382 2130.26 141.604 Q2128.34 143.803 2128.34 147.576 L2128.34 162.229 L2124.06 162.229 L2124.06 136.303 L2128.34 136.303 L2128.34 140.331 Q2129.8 137.946 2131.84 136.812 Q2133.87 135.678 2136.67 135.678 Q2139.5 135.678 2141.47 137.113 Q2143.46 138.548 2144.41 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2190.1 170.099 L2190.1 173.409 L2165.47 173.409 L2165.47 170.099 L2190.1 170.099 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2194.1 136.303 L2198.36 136.303 L2198.36 162.229 L2194.1 162.229 L2194.1 136.303 M2194.1 126.21 L2198.36 126.21 L2198.36 131.604 L2194.1 131.604 L2194.1 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2207.28 136.303 L2211.54 136.303 L2211.54 162.692 Q2211.54 167.645 2209.64 169.867 Q2207.76 172.09 2203.57 172.09 L2201.95 172.09 L2201.95 168.479 L2203.09 168.479 Q2205.52 168.479 2206.4 167.344 Q2207.28 166.233 2207.28 162.692 L2207.28 136.303 M2207.28 126.21 L2211.54 126.21 L2211.54 131.604 L2207.28 131.604 L2207.28 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2224.57 158.34 L2224.57 172.09 L2220.29 172.09 L2220.29 136.303 L2224.57 136.303 L2224.57 140.238 Q2225.91 137.923 2227.95 136.812 Q2230.01 135.678 2232.85 135.678 Q2237.58 135.678 2240.52 139.428 Q2243.48 143.178 2243.48 149.289 Q2243.48 155.4 2240.52 159.15 Q2237.58 162.9 2232.85 162.9 Q2230.01 162.9 2227.95 161.789 Q2225.91 160.655 2224.57 158.34 M2239.06 149.289 Q2239.06 144.59 2237.11 141.928 Q2235.19 139.243 2231.81 139.243 Q2228.43 139.243 2226.49 141.928 Q2224.57 144.59 2224.57 149.289 Q2224.57 153.988 2226.49 156.673 Q2228.43 159.335 2231.81 159.335 Q2235.19 159.335 2237.11 156.673 Q2239.06 153.988 2239.06 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip680)" d="M2253.22 156.349 L2257.92 156.349 L2257.92 162.229 L2253.22 162.229 L2253.22 156.349 M2253.22 127.669 L2257.92 127.669 L2257.92 142.831 L2257.46 151.094 L2253.71 151.094 L2253.22 142.831 L2253.22 127.669 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
</div></div>
</div>
<section id="questions-and-observations">
<h4>Questions and observations:<a class="headerlink" href="#questions-and-observations" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Why do some orderings get better performance?</p></li>
<li><p>For both the <code class="docutils literal notranslate"><span class="pre">jpi</span></code> (Algo 2.5) and <code class="docutils literal notranslate"><span class="pre">pji</span></code> (Algo 2.4) loop orderings, the inner loop accesses columns of <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(A\)</span>. However,</p>
<ul>
<li><p>Each execution of the inner loop of the <code class="docutils literal notranslate"><span class="pre">jpi</span></code> (Algo 2.5) ordering updates the same column of <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
<li><p>Each execution of the inner loop of the <code class="docutils literal notranslate"><span class="pre">pji</span></code> (Algo 2.4) ordering updates a different column of <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These results are influenced by the fact that Julia uses <strong>column-major</strong> storing of multidimensional arrays.</p>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sdsu-comp605/spring25",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="module2-1_measuring_performance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">6) Measuring Performance</p>
      </div>
    </a>
    <a class="right-next"
       href="module2-3_blocked_mmm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8) Blocked Matrix-Matrix Multiplication</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-cpu-optimization">1. Introduction to CPU Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-matrix-multiply">1.1 Matrix-Matrix Multiply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering">2. Loop ordering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ijp">2.1 Loop ordering: ijp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ipj">2.2 Loop ordering: ipj</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pij">2.3 Loop ordering: pij</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pji">2.4 Loop ordering: pji</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jpi">2.5 Loop ordering: jpi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jip">2.6 Loop ordering: jip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-and-observations">Questions and observations:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valeria Barra
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>